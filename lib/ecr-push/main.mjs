import { createRequire } from "module";const require = createRequire(import.meta.url);
var Au=Object.create;var vo=Object.defineProperty;var vu=Object.getOwnPropertyDescriptor;var Nu=Object.getOwnPropertyNames;var Ou=Object.getPrototypeOf,ku=Object.prototype.hasOwnProperty;var F=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var K=(e,t)=>()=>(e&&(t=e(e=0)),t);var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Us=(e,t)=>{for(var r in t)vo(e,r,{get:t[r],enumerable:!0})},Ai=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Nu(t))!ku.call(e,s)&&s!==r&&vo(e,s,{get:()=>t[s],enumerable:!(o=vu(t,s))||o.enumerable});return e};var vi=(e,t,r)=>(r=e!=null?Au(Ou(e)):{},Ai(t||!e||!e.__esModule?vo(r,"default",{value:e,enumerable:!0}):r,e)),Du=e=>Ai(vo({},"__esModule",{value:!0}),e);var No=P(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.toCommandProperties=Wt.toCommandValue=void 0;function Fu(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}Wt.toCommandValue=Fu;function $u(e){return Object.keys(e).length?{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}}Wt.toCommandProperties=$u});var Di=P(de=>{"use strict";var Lu=de&&de.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),Mu=de&&de.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Uu=de&&de.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Lu(t,e,r);return Mu(t,e),t};Object.defineProperty(de,"__esModule",{value:!0});de.issue=de.issueCommand=void 0;var zu=Uu(F("os")),Oi=No();function ki(e,t,r){let o=new zs(e,t,r);process.stdout.write(o.toString()+zu.EOL)}de.issueCommand=ki;function qu(e,t=""){ki(e,{},t)}de.issue=qu;var Ni="::",zs=class{constructor(t,r,o){t||(t="missing.command"),this.command=t,this.properties=r,this.message=o}toString(){let t=Ni+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(let o in this.properties)if(this.properties.hasOwnProperty(o)){let s=this.properties[o];s&&(r?r=!1:t+=",",t+=`${o}=${ju(s)}`)}}return t+=`${Ni}${Bu(this.message)}`,t}};function Bu(e){return Oi.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function ju(e){return Oi.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});import Gu from"crypto";function Xr(){return Oo>ko.length-16&&(Gu.randomFillSync(ko),Oo=0),ko.slice(Oo,Oo+=16)}var ko,Oo,qs=K(()=>{ko=new Uint8Array(256),Oo=ko.length});var Fi,$i=K(()=>{Fi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function Vu(e){return typeof e=="string"&&Fi.test(e)}var Ke,Qr=K(()=>{$i();Ke=Vu});function Hu(e,t=0){let r=(q[e[t+0]]+q[e[t+1]]+q[e[t+2]]+q[e[t+3]]+"-"+q[e[t+4]]+q[e[t+5]]+"-"+q[e[t+6]]+q[e[t+7]]+"-"+q[e[t+8]]+q[e[t+9]]+"-"+q[e[t+10]]+q[e[t+11]]+q[e[t+12]]+q[e[t+13]]+q[e[t+14]]+q[e[t+15]]).toLowerCase();if(!Ke(r))throw TypeError("Stringified UUID is invalid");return r}var q,Ye,Zr=K(()=>{Qr();q=[];for(let e=0;e<256;++e)q.push((e+256).toString(16).substr(1));Ye=Hu});function Wu(e,t,r){let o=t&&r||0,s=t||new Array(16);e=e||{};let n=e.node||Li,i=e.clockseq!==void 0?e.clockseq:Bs;if(n==null||i==null){let u=e.random||(e.rng||Xr)();n==null&&(n=Li=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),i==null&&(i=Bs=(u[6]<<8|u[7])&16383)}let a=e.msecs!==void 0?e.msecs:Date.now(),c=e.nsecs!==void 0?e.nsecs:Gs+1,d=a-js+(c-Gs)/1e4;if(d<0&&e.clockseq===void 0&&(i=i+1&16383),(d<0||a>js)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");js=a,Gs=c,Bs=i,a+=122192928e5;let l=((a&268435455)*1e4+c)%4294967296;s[o++]=l>>>24&255,s[o++]=l>>>16&255,s[o++]=l>>>8&255,s[o++]=l&255;let p=a/4294967296*1e4&268435455;s[o++]=p>>>8&255,s[o++]=p&255,s[o++]=p>>>24&15|16,s[o++]=p>>>16&255,s[o++]=i>>>8|128,s[o++]=i&255;for(let u=0;u<6;++u)s[o+u]=n[u];return t||Ye(s)}var Li,Bs,js,Gs,Mi,Ui=K(()=>{qs();Zr();js=0,Gs=0;Mi=Wu});function Ku(e){if(!Ke(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var Do,Vs=K(()=>{Qr();Do=Ku});function Yu(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}function Fo(e,t,r){function o(s,n,i,a){if(typeof s=="string"&&(s=Yu(s)),typeof n=="string"&&(n=Do(n)),n.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+s.length);if(c.set(n),c.set(s,n.length),c=r(c),c[6]=c[6]&15|t,c[8]=c[8]&63|128,i){a=a||0;for(let d=0;d<16;++d)i[a+d]=c[d];return i}return Ye(c)}try{o.name=e}catch{}return o.DNS=Ju,o.URL=Xu,o}var Ju,Xu,Hs=K(()=>{Zr();Vs();Ju="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Xu="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});import Qu from"crypto";function Zu(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),Qu.createHash("md5").update(e).digest()}var zi,qi=K(()=>{zi=Zu});var em,Bi,ji=K(()=>{Hs();qi();em=Fo("v3",48,zi),Bi=em});function tm(e,t,r){e=e||{};let o=e.random||(e.rng||Xr)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){r=r||0;for(let s=0;s<16;++s)t[r+s]=o[s];return t}return Ye(o)}var $o,Gi=K(()=>{qs();Zr();$o=tm});import rm from"crypto";function om(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),rm.createHash("sha1").update(e).digest()}var Vi,Hi=K(()=>{Vi=om});var sm,Wi,Ki=K(()=>{Hs();Hi();sm=Fo("v5",80,Vi),Wi=sm});var Yi,Ji=K(()=>{Yi="00000000-0000-0000-0000-000000000000"});function nm(e){if(!Ke(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var Xi,Qi=K(()=>{Qr();Xi=nm});var Zi={};Us(Zi,{NIL:()=>Yi,parse:()=>Do,stringify:()=>Ye,v1:()=>Mi,v3:()=>Bi,v4:()=>$o,v5:()=>Wi,validate:()=>Ke,version:()=>Xi});var Ws=K(()=>{Ui();ji();Gi();Ki();Ji();Qi();Qr();Zr();Vs()});var oa=P(le=>{"use strict";var im=le&&le.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),am=le&&le.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ta=le&&le.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&im(t,e,r);return am(t,e),t};Object.defineProperty(le,"__esModule",{value:!0});le.prepareKeyValueMessage=le.issueFileCommand=void 0;var ea=ta(F("fs")),Ks=ta(F("os")),cm=(Ws(),Du(Zi)),ra=No();function dm(e,t){let r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!ea.existsSync(r))throw new Error(`Missing file at path: ${r}`);ea.appendFileSync(r,`${ra.toCommandValue(t)}${Ks.EOL}`,{encoding:"utf8"})}le.issueFileCommand=dm;function lm(e,t){let r=`ghadelimiter_${cm.v4()}`,o=ra.toCommandValue(t);if(e.includes(r))throw new Error(`Unexpected input: name should not contain the delimiter "${r}"`);if(o.includes(r))throw new Error(`Unexpected input: value should not contain the delimiter "${r}"`);return`${e}<<${r}${Ks.EOL}${o}${Ks.EOL}${r}`}le.prepareKeyValueMessage=lm});var na=P(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.checkBypass=Kt.getProxyUrl=void 0;function pm(e){let t=e.protocol==="https:";if(sa(e))return;let r=(()=>t?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY)();if(r)return new URL(r)}Kt.getProxyUrl=pm;function sa(e){if(!e.hostname)return!1;let t=e.hostname;if(um(t))return!0;let r=process.env.no_proxy||process.env.NO_PROXY||"";if(!r)return!1;let o;e.port?o=Number(e.port):e.protocol==="http:"?o=80:e.protocol==="https:"&&(o=443);let s=[e.hostname.toUpperCase()];typeof o=="number"&&s.push(`${s[0]}:${o}`);for(let n of r.split(",").map(i=>i.trim().toUpperCase()).filter(i=>i))if(n==="*"||s.some(i=>i===n||i.endsWith(`.${n}`)||n.startsWith(".")&&i.endsWith(`${n}`)))return!0;return!1}Kt.checkBypass=sa;function um(e){let t=e.toLowerCase();return t==="localhost"||t.startsWith("127.")||t.startsWith("[::1]")||t.startsWith("[0:0:0:0:0:0:0:1]")}});var da=P(Yt=>{"use strict";var yx=F("net"),mm=F("tls"),Ys=F("http"),ia=F("https"),fm=F("events"),Ex=F("assert"),hm=F("util");Yt.httpOverHttp=ym;Yt.httpsOverHttp=Em;Yt.httpOverHttps=gm;Yt.httpsOverHttps=wm;function ym(e){var t=new Le(e);return t.request=Ys.request,t}function Em(e){var t=new Le(e);return t.request=Ys.request,t.createSocket=aa,t.defaultPort=443,t}function gm(e){var t=new Le(e);return t.request=ia.request,t}function wm(e){var t=new Le(e);return t.request=ia.request,t.createSocket=aa,t.defaultPort=443,t}function Le(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||Ys.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",function(o,s,n,i){for(var a=ca(s,n,i),c=0,d=t.requests.length;c<d;++c){var l=t.requests[c];if(l.host===a.host&&l.port===a.port){t.requests.splice(c,1),l.request.onSocket(o);return}}o.destroy(),t.removeSocket(o)})}hm.inherits(Le,fm.EventEmitter);Le.prototype.addRequest=function(t,r,o,s){var n=this,i=Js({request:t},n.options,ca(r,o,s));if(n.sockets.length>=this.maxSockets){n.requests.push(i);return}n.createSocket(i,function(a){a.on("free",c),a.on("close",d),a.on("agentRemove",d),t.onSocket(a);function c(){n.emit("free",a,i)}function d(l){n.removeSocket(a),a.removeListener("free",c),a.removeListener("close",d),a.removeListener("agentRemove",d)}})};Le.prototype.createSocket=function(t,r){var o=this,s={};o.sockets.push(s);var n=Js({},o.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(n.localAddress=t.localAddress),n.proxyAuth&&(n.headers=n.headers||{},n.headers["Proxy-Authorization"]="Basic "+new Buffer(n.proxyAuth).toString("base64")),Je("making CONNECT request");var i=o.request(n);i.useChunkedEncodingByDefault=!1,i.once("response",a),i.once("upgrade",c),i.once("connect",d),i.once("error",l),i.end();function a(p){p.upgrade=!0}function c(p,u,m){process.nextTick(function(){d(p,u,m)})}function d(p,u,m){if(i.removeAllListeners(),u.removeAllListeners(),p.statusCode!==200){Je("tunneling socket could not be established, statusCode=%d",p.statusCode),u.destroy();var f=new Error("tunneling socket could not be established, statusCode="+p.statusCode);f.code="ECONNRESET",t.request.emit("error",f),o.removeSocket(s);return}if(m.length>0){Je("got illegal response body from proxy"),u.destroy();var f=new Error("got illegal response body from proxy");f.code="ECONNRESET",t.request.emit("error",f),o.removeSocket(s);return}return Je("tunneling connection has established"),o.sockets[o.sockets.indexOf(s)]=u,r(u)}function l(p){i.removeAllListeners(),Je(`tunneling socket could not be established, cause=%s
`,p.message,p.stack);var u=new Error("tunneling socket could not be established, cause="+p.message);u.code="ECONNRESET",t.request.emit("error",u),o.removeSocket(s)}};Le.prototype.removeSocket=function(t){var r=this.sockets.indexOf(t);if(r!==-1){this.sockets.splice(r,1);var o=this.requests.shift();o&&this.createSocket(o,function(s){o.request.onSocket(s)})}};function aa(e,t){var r=this;Le.prototype.createSocket.call(r,e,function(o){var s=e.request.getHeader("host"),n=Js({},r.options,{socket:o,servername:s?s.replace(/:.*$/,""):e.host}),i=mm.connect(0,n);r.sockets[r.sockets.indexOf(o)]=i,t(i)})}function ca(e,t,r){return typeof e=="string"?{host:e,port:t,localAddress:r}:e}function Js(e){for(var t=1,r=arguments.length;t<r;++t){var o=arguments[t];if(typeof o=="object")for(var s=Object.keys(o),n=0,i=s.length;n<i;++n){var a=s[n];o[a]!==void 0&&(e[a]=o[a])}}return e}var Je;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?Je=function(){var e=Array.prototype.slice.call(arguments);typeof e[0]=="string"?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:Je=function(){};Yt.debug=Je});var pa=P((wx,la)=>{la.exports=da()});var ma=P(T=>{"use strict";var xm=T&&T.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),Sm=T&&T.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qo=T&&T.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&xm(t,e,r);return Sm(t,e),t},L=T&&T.__awaiter||function(e,t,r,o){function s(n){return n instanceof r?n:new r(function(i){i(n)})}return new(r||(r=Promise))(function(n,i){function a(l){try{d(o.next(l))}catch(p){i(p)}}function c(l){try{d(o.throw(l))}catch(p){i(p)}}function d(l){l.done?n(l.value):s(l.value).then(a,c)}d((o=o.apply(e,t||[])).next())})};Object.defineProperty(T,"__esModule",{value:!0});T.HttpClient=T.isHttps=T.HttpClientResponse=T.HttpClientError=T.getProxyUrl=T.MediaTypes=T.Headers=T.HttpCodes=void 0;var Lo=qo(F("http")),Xs=qo(F("https")),ua=qo(na()),Mo=qo(pa()),Ee;(function(e){e[e.OK=200]="OK",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.ResourceMoved=302]="ResourceMoved",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.SwitchProxy=306]="SwitchProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"})(Ee=T.HttpCodes||(T.HttpCodes={}));var Y;(function(e){e.Accept="accept",e.ContentType="content-type"})(Y=T.Headers||(T.Headers={}));var Xe;(function(e){e.ApplicationJson="application/json"})(Xe=T.MediaTypes||(T.MediaTypes={}));function _m(e){let t=ua.getProxyUrl(new URL(e));return t?t.href:""}T.getProxyUrl=_m;var bm=[Ee.MovedPermanently,Ee.ResourceMoved,Ee.SeeOther,Ee.TemporaryRedirect,Ee.PermanentRedirect],Rm=[Ee.BadGateway,Ee.ServiceUnavailable,Ee.GatewayTimeout],Tm=["OPTIONS","GET","DELETE","HEAD"],Im=10,Cm=5,Jt=class extends Error{constructor(t,r){super(t),this.name="HttpClientError",this.statusCode=r,Object.setPrototypeOf(this,Jt.prototype)}};T.HttpClientError=Jt;var zo=class{constructor(t){this.message=t}readBody(){return L(this,void 0,void 0,function*(){return new Promise(t=>L(this,void 0,void 0,function*(){let r=Buffer.alloc(0);this.message.on("data",o=>{r=Buffer.concat([r,o])}),this.message.on("end",()=>{t(r.toString())})}))})}};T.HttpClientResponse=zo;function Pm(e){return new URL(e).protocol==="https:"}T.isHttps=Pm;var Qs=class{constructor(t,r,o){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=r||[],this.requestOptions=o,o&&(o.ignoreSslError!=null&&(this._ignoreSslError=o.ignoreSslError),this._socketTimeout=o.socketTimeout,o.allowRedirects!=null&&(this._allowRedirects=o.allowRedirects),o.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=o.allowRedirectDowngrade),o.maxRedirects!=null&&(this._maxRedirects=Math.max(o.maxRedirects,0)),o.keepAlive!=null&&(this._keepAlive=o.keepAlive),o.allowRetries!=null&&(this._allowRetries=o.allowRetries),o.maxRetries!=null&&(this._maxRetries=o.maxRetries))}options(t,r){return L(this,void 0,void 0,function*(){return this.request("OPTIONS",t,null,r||{})})}get(t,r){return L(this,void 0,void 0,function*(){return this.request("GET",t,null,r||{})})}del(t,r){return L(this,void 0,void 0,function*(){return this.request("DELETE",t,null,r||{})})}post(t,r,o){return L(this,void 0,void 0,function*(){return this.request("POST",t,r,o||{})})}patch(t,r,o){return L(this,void 0,void 0,function*(){return this.request("PATCH",t,r,o||{})})}put(t,r,o){return L(this,void 0,void 0,function*(){return this.request("PUT",t,r,o||{})})}head(t,r){return L(this,void 0,void 0,function*(){return this.request("HEAD",t,null,r||{})})}sendStream(t,r,o,s){return L(this,void 0,void 0,function*(){return this.request(t,r,o,s)})}getJson(t,r={}){return L(this,void 0,void 0,function*(){r[Y.Accept]=this._getExistingOrDefaultHeader(r,Y.Accept,Xe.ApplicationJson);let o=yield this.get(t,r);return this._processResponse(o,this.requestOptions)})}postJson(t,r,o={}){return L(this,void 0,void 0,function*(){let s=JSON.stringify(r,null,2);o[Y.Accept]=this._getExistingOrDefaultHeader(o,Y.Accept,Xe.ApplicationJson),o[Y.ContentType]=this._getExistingOrDefaultHeader(o,Y.ContentType,Xe.ApplicationJson);let n=yield this.post(t,s,o);return this._processResponse(n,this.requestOptions)})}putJson(t,r,o={}){return L(this,void 0,void 0,function*(){let s=JSON.stringify(r,null,2);o[Y.Accept]=this._getExistingOrDefaultHeader(o,Y.Accept,Xe.ApplicationJson),o[Y.ContentType]=this._getExistingOrDefaultHeader(o,Y.ContentType,Xe.ApplicationJson);let n=yield this.put(t,s,o);return this._processResponse(n,this.requestOptions)})}patchJson(t,r,o={}){return L(this,void 0,void 0,function*(){let s=JSON.stringify(r,null,2);o[Y.Accept]=this._getExistingOrDefaultHeader(o,Y.Accept,Xe.ApplicationJson),o[Y.ContentType]=this._getExistingOrDefaultHeader(o,Y.ContentType,Xe.ApplicationJson);let n=yield this.patch(t,s,o);return this._processResponse(n,this.requestOptions)})}request(t,r,o,s){return L(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");let n=new URL(r),i=this._prepareRequest(t,n,s),a=this._allowRetries&&Tm.includes(t)?this._maxRetries+1:1,c=0,d;do{if(d=yield this.requestRaw(i,o),d&&d.message&&d.message.statusCode===Ee.Unauthorized){let p;for(let u of this.handlers)if(u.canHandleAuthentication(d)){p=u;break}return p?p.handleAuthentication(this,i,o):d}let l=this._maxRedirects;for(;d.message.statusCode&&bm.includes(d.message.statusCode)&&this._allowRedirects&&l>0;){let p=d.message.headers.location;if(!p)break;let u=new URL(p);if(n.protocol==="https:"&&n.protocol!==u.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield d.readBody(),u.hostname!==n.hostname)for(let m in s)m.toLowerCase()==="authorization"&&delete s[m];i=this._prepareRequest(t,u,s),d=yield this.requestRaw(i,o),l--}if(!d.message.statusCode||!Rm.includes(d.message.statusCode))return d;c+=1,c<a&&(yield d.readBody(),yield this._performExponentialBackoff(c))}while(c<a);return d})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,r){return L(this,void 0,void 0,function*(){return new Promise((o,s)=>{function n(i,a){i?s(i):a?o(a):s(new Error("Unknown error"))}this.requestRawWithCallback(t,r,n)})})}requestRawWithCallback(t,r,o){typeof r=="string"&&(t.options.headers||(t.options.headers={}),t.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8"));let s=!1;function n(c,d){s||(s=!0,o(c,d))}let i=t.httpModule.request(t.options,c=>{let d=new zo(c);n(void 0,d)}),a;i.on("socket",c=>{a=c}),i.setTimeout(this._socketTimeout||3*6e4,()=>{a&&a.end(),n(new Error(`Request timeout: ${t.options.path}`))}),i.on("error",function(c){n(c)}),r&&typeof r=="string"&&i.write(r,"utf8"),r&&typeof r!="string"?(r.on("close",function(){i.end()}),r.pipe(i)):i.end()}getAgent(t){let r=new URL(t);return this._getAgent(r)}_prepareRequest(t,r,o){let s={};s.parsedUrl=r;let n=s.parsedUrl.protocol==="https:";s.httpModule=n?Xs:Lo;let i=n?443:80;if(s.options={},s.options.host=s.parsedUrl.hostname,s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):i,s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||""),s.options.method=t,s.options.headers=this._mergeHeaders(o),this.userAgent!=null&&(s.options.headers["user-agent"]=this.userAgent),s.options.agent=this._getAgent(s.parsedUrl),this.handlers)for(let a of this.handlers)a.prepareRequest(s.options);return s}_mergeHeaders(t){return this.requestOptions&&this.requestOptions.headers?Object.assign({},Uo(this.requestOptions.headers),Uo(t||{})):Uo(t||{})}_getExistingOrDefaultHeader(t,r,o){let s;return this.requestOptions&&this.requestOptions.headers&&(s=Uo(this.requestOptions.headers)[r]),t[r]||s||o}_getAgent(t){let r,o=ua.getProxyUrl(t),s=o&&o.hostname;if(this._keepAlive&&s&&(r=this._proxyAgent),this._keepAlive&&!s&&(r=this._agent),r)return r;let n=t.protocol==="https:",i=100;if(this.requestOptions&&(i=this.requestOptions.maxSockets||Lo.globalAgent.maxSockets),o&&o.hostname){let a={maxSockets:i,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(o.username||o.password)&&{proxyAuth:`${o.username}:${o.password}`}),{host:o.hostname,port:o.port})},c,d=o.protocol==="https:";n?c=d?Mo.httpsOverHttps:Mo.httpsOverHttp:c=d?Mo.httpOverHttps:Mo.httpOverHttp,r=c(a),this._proxyAgent=r}if(this._keepAlive&&!r){let a={keepAlive:this._keepAlive,maxSockets:i};r=n?new Xs.Agent(a):new Lo.Agent(a),this._agent=r}return r||(r=n?Xs.globalAgent:Lo.globalAgent),n&&this._ignoreSslError&&(r.options=Object.assign(r.options||{},{rejectUnauthorized:!1})),r}_performExponentialBackoff(t){return L(this,void 0,void 0,function*(){t=Math.min(Im,t);let r=Cm*Math.pow(2,t);return new Promise(o=>setTimeout(()=>o(),r))})}_processResponse(t,r){return L(this,void 0,void 0,function*(){return new Promise((o,s)=>L(this,void 0,void 0,function*(){let n=t.message.statusCode||0,i={statusCode:n,result:null,headers:{}};n===Ee.NotFound&&o(i);function a(l,p){if(typeof p=="string"){let u=new Date(p);if(!isNaN(u.valueOf()))return u}return p}let c,d;try{d=yield t.readBody(),d&&d.length>0&&(r&&r.deserializeDates?c=JSON.parse(d,a):c=JSON.parse(d),i.result=c),i.headers=t.message.headers}catch{}if(n>299){let l;c&&c.message?l=c.message:d&&d.length>0?l=d:l=`Failed request: (${n})`;let p=new Jt(l,n);p.result=i.result,s(p)}else o(i)}))})}};T.HttpClient=Qs;var Uo=e=>Object.keys(e).reduce((t,r)=>(t[r.toLowerCase()]=e[r],t),{})});var fa=P(we=>{"use strict";var rn=we&&we.__awaiter||function(e,t,r,o){function s(n){return n instanceof r?n:new r(function(i){i(n)})}return new(r||(r=Promise))(function(n,i){function a(l){try{d(o.next(l))}catch(p){i(p)}}function c(l){try{d(o.throw(l))}catch(p){i(p)}}function d(l){l.done?n(l.value):s(l.value).then(a,c)}d((o=o.apply(e,t||[])).next())})};Object.defineProperty(we,"__esModule",{value:!0});we.PersonalAccessTokenCredentialHandler=we.BearerCredentialHandler=we.BasicCredentialHandler=void 0;var Zs=class{constructor(t,r){this.username=t,this.password=r}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return rn(this,void 0,void 0,function*(){throw new Error("not implemented")})}};we.BasicCredentialHandler=Zs;var en=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return rn(this,void 0,void 0,function*(){throw new Error("not implemented")})}};we.BearerCredentialHandler=en;var tn=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return rn(this,void 0,void 0,function*(){throw new Error("not implemented")})}};we.PersonalAccessTokenCredentialHandler=tn});var Ea=P(Xt=>{"use strict";var ha=Xt&&Xt.__awaiter||function(e,t,r,o){function s(n){return n instanceof r?n:new r(function(i){i(n)})}return new(r||(r=Promise))(function(n,i){function a(l){try{d(o.next(l))}catch(p){i(p)}}function c(l){try{d(o.throw(l))}catch(p){i(p)}}function d(l){l.done?n(l.value):s(l.value).then(a,c)}d((o=o.apply(e,t||[])).next())})};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.OidcClient=void 0;var Am=ma(),vm=fa(),ya=on(),Qe=class{static createHttpClient(t=!0,r=10){let o={allowRetries:t,maxRetries:r};return new Am.HttpClient("actions/oidc-client",[new vm.BearerCredentialHandler(Qe.getRequestToken())],o)}static getRequestToken(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return t}static getIDTokenUrl(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return t}static getCall(t){var r;return ha(this,void 0,void 0,function*(){let n=(r=(yield Qe.createHttpClient().getJson(t).catch(i=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${i.statusCode}
 
        Error Message: ${i.result.message}`)})).result)===null||r===void 0?void 0:r.value;if(!n)throw new Error("Response json body do not have ID Token field");return n})}static getIDToken(t){return ha(this,void 0,void 0,function*(){try{let r=Qe.getIDTokenUrl();if(t){let s=encodeURIComponent(t);r=`${r}&audience=${s}`}ya.debug(`ID token url is ${r}`);let o=yield Qe.getCall(r);return ya.setSecret(o),o}catch(r){throw new Error(`Error message: ${r.message}`)}})}};Xt.OidcClient=Qe});var cn=P(X=>{"use strict";var sn=X&&X.__awaiter||function(e,t,r,o){function s(n){return n instanceof r?n:new r(function(i){i(n)})}return new(r||(r=Promise))(function(n,i){function a(l){try{d(o.next(l))}catch(p){i(p)}}function c(l){try{d(o.throw(l))}catch(p){i(p)}}function d(l){l.done?n(l.value):s(l.value).then(a,c)}d((o=o.apply(e,t||[])).next())})};Object.defineProperty(X,"__esModule",{value:!0});X.summary=X.markdownSummary=X.SUMMARY_DOCS_URL=X.SUMMARY_ENV_VAR=void 0;var Nm=F("os"),nn=F("fs"),{access:Om,appendFile:km,writeFile:Dm}=nn.promises;X.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";X.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";var an=class{constructor(){this._buffer=""}filePath(){return sn(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let t=process.env[X.SUMMARY_ENV_VAR];if(!t)throw new Error(`Unable to find environment variable for $${X.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield Om(t,nn.constants.R_OK|nn.constants.W_OK)}catch{throw new Error(`Unable to access summary file: '${t}'. Check if the file has correct read/write permissions.`)}return this._filePath=t,this._filePath})}wrap(t,r,o={}){let s=Object.entries(o).map(([n,i])=>` ${n}="${i}"`).join("");return r?`<${t}${s}>${r}</${t}>`:`<${t}${s}>`}write(t){return sn(this,void 0,void 0,function*(){let r=!!(t!=null&&t.overwrite),o=yield this.filePath();return yield(r?Dm:km)(o,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return sn(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(t,r=!1){return this._buffer+=t,r?this.addEOL():this}addEOL(){return this.addRaw(Nm.EOL)}addCodeBlock(t,r){let o=Object.assign({},r&&{lang:r}),s=this.wrap("pre",this.wrap("code",t),o);return this.addRaw(s).addEOL()}addList(t,r=!1){let o=r?"ol":"ul",s=t.map(i=>this.wrap("li",i)).join(""),n=this.wrap(o,s);return this.addRaw(n).addEOL()}addTable(t){let r=t.map(s=>{let n=s.map(i=>{if(typeof i=="string")return this.wrap("td",i);let{header:a,data:c,colspan:d,rowspan:l}=i,p=a?"th":"td",u=Object.assign(Object.assign({},d&&{colspan:d}),l&&{rowspan:l});return this.wrap(p,c,u)}).join("");return this.wrap("tr",n)}).join(""),o=this.wrap("table",r);return this.addRaw(o).addEOL()}addDetails(t,r){let o=this.wrap("details",this.wrap("summary",t)+r);return this.addRaw(o).addEOL()}addImage(t,r,o){let{width:s,height:n}=o||{},i=Object.assign(Object.assign({},s&&{width:s}),n&&{height:n}),a=this.wrap("img",null,Object.assign({src:t,alt:r},i));return this.addRaw(a).addEOL()}addHeading(t,r){let o=`h${r}`,s=["h1","h2","h3","h4","h5","h6"].includes(o)?o:"h1",n=this.wrap(s,t);return this.addRaw(n).addEOL()}addSeparator(){let t=this.wrap("hr",null);return this.addRaw(t).addEOL()}addBreak(){let t=this.wrap("br",null);return this.addRaw(t).addEOL()}addQuote(t,r){let o=Object.assign({},r&&{cite:r}),s=this.wrap("blockquote",t,o);return this.addRaw(s).addEOL()}addLink(t,r){let o=this.wrap("a",t,{href:r});return this.addRaw(o).addEOL()}},ga=new an;X.markdownSummary=ga;X.summary=ga});var wa=P(Q=>{"use strict";var Fm=Q&&Q.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),$m=Q&&Q.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Lm=Q&&Q.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Fm(t,e,r);return $m(t,e),t};Object.defineProperty(Q,"__esModule",{value:!0});Q.toPlatformPath=Q.toWin32Path=Q.toPosixPath=void 0;var Mm=Lm(F("path"));function Um(e){return e.replace(/[\\]/g,"/")}Q.toPosixPath=Um;function zm(e){return e.replace(/[/]/g,"\\")}Q.toWin32Path=zm;function qm(e){return e.replace(/[/\\]/g,Mm.sep)}Q.toPlatformPath=qm});var on=P(y=>{"use strict";var Bm=y&&y.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),jm=y&&y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),xa=y&&y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Bm(t,e,r);return jm(t,e),t},Sa=y&&y.__awaiter||function(e,t,r,o){function s(n){return n instanceof r?n:new r(function(i){i(n)})}return new(r||(r=Promise))(function(n,i){function a(l){try{d(o.next(l))}catch(p){i(p)}}function c(l){try{d(o.throw(l))}catch(p){i(p)}}function d(l){l.done?n(l.value):s(l.value).then(a,c)}d((o=o.apply(e,t||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});y.getIDToken=y.getState=y.saveState=y.group=y.endGroup=y.startGroup=y.info=y.notice=y.warning=y.error=y.debug=y.isDebug=y.setFailed=y.setCommandEcho=y.setOutput=y.getBooleanInput=y.getMultilineInput=y.getInput=y.addPath=y.setSecret=y.exportVariable=y.ExitCode=void 0;var pe=Di(),Ft=oa(),Qt=No(),_a=xa(F("os")),Gm=xa(F("path")),Vm=Ea(),ba;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(ba=y.ExitCode||(y.ExitCode={}));function Hm(e,t){let r=Qt.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV||"")return Ft.issueFileCommand("ENV",Ft.prepareKeyValueMessage(e,t));pe.issueCommand("set-env",{name:e},r)}y.exportVariable=Hm;function Wm(e){pe.issueCommand("add-mask",{},e)}y.setSecret=Wm;function Km(e){process.env.GITHUB_PATH||""?Ft.issueFileCommand("PATH",e):pe.issueCommand("add-path",{},e),process.env.PATH=`${e}${Gm.delimiter}${process.env.PATH}`}y.addPath=Km;function dn(e,t){let r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return t&&t.trimWhitespace===!1?r:r.trim()}y.getInput=dn;function Ym(e,t){let r=dn(e,t).split(`
`).filter(o=>o!=="");return t&&t.trimWhitespace===!1?r:r.map(o=>o.trim())}y.getMultilineInput=Ym;function Jm(e,t){let r=["true","True","TRUE"],o=["false","False","FALSE"],s=dn(e,t);if(r.includes(s))return!0;if(o.includes(s))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}y.getBooleanInput=Jm;function Xm(e,t){if(process.env.GITHUB_OUTPUT||"")return Ft.issueFileCommand("OUTPUT",Ft.prepareKeyValueMessage(e,t));process.stdout.write(_a.EOL),pe.issueCommand("set-output",{name:e},Qt.toCommandValue(t))}y.setOutput=Xm;function Qm(e){pe.issue("echo",e?"on":"off")}y.setCommandEcho=Qm;function Zm(e){process.exitCode=ba.Failure,Ra(e)}y.setFailed=Zm;function ef(){return process.env.RUNNER_DEBUG==="1"}y.isDebug=ef;function tf(e){pe.issueCommand("debug",{},e)}y.debug=tf;function Ra(e,t={}){pe.issueCommand("error",Qt.toCommandProperties(t),e instanceof Error?e.toString():e)}y.error=Ra;function rf(e,t={}){pe.issueCommand("warning",Qt.toCommandProperties(t),e instanceof Error?e.toString():e)}y.warning=rf;function of(e,t={}){pe.issueCommand("notice",Qt.toCommandProperties(t),e instanceof Error?e.toString():e)}y.notice=of;function sf(e){process.stdout.write(e+_a.EOL)}y.info=sf;function Ta(e){pe.issue("group",e)}y.startGroup=Ta;function Ia(){pe.issue("endgroup")}y.endGroup=Ia;function nf(e,t){return Sa(this,void 0,void 0,function*(){Ta(e);let r;try{r=yield t()}finally{Ia()}return r})}y.group=nf;function af(e,t){if(process.env.GITHUB_STATE||"")return Ft.issueFileCommand("STATE",Ft.prepareKeyValueMessage(e,t));pe.issueCommand("save-state",{name:e},Qt.toCommandValue(t))}y.saveState=af;function cf(e){return process.env[`STATE_${e}`]||""}y.getState=cf;function df(e){return Sa(this,void 0,void 0,function*(){return yield Vm.OidcClient.getIDToken(e)})}y.getIDToken=df;var lf=cn();Object.defineProperty(y,"summary",{enumerable:!0,get:function(){return lf.summary}});var pf=cn();Object.defineProperty(y,"markdownSummary",{enumerable:!0,get:function(){return pf.markdownSummary}});var ln=wa();Object.defineProperty(y,"toPosixPath",{enumerable:!0,get:function(){return ln.toPosixPath}});Object.defineProperty(y,"toWin32Path",{enumerable:!0,get:function(){return ln.toWin32Path}});Object.defineProperty(y,"toPlatformPath",{enumerable:!0,get:function(){return ln.toPlatformPath}})});var Kn=P(ze=>{"use strict";var ad=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Wh=ad+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",cd="["+ad+"]["+Wh+"]*",Kh=new RegExp("^"+cd+"$"),Yh=function(e,t){let r=[],o=t.exec(e);for(;o;){let s=[];s.startIndex=t.lastIndex-o[0].length;let n=o.length;for(let i=0;i<n;i++)s.push(o[i]);r.push(s),o=t.exec(e)}return r},Jh=function(e){let t=Kh.exec(e);return!(t===null||typeof t>"u")};ze.isExist=function(e){return typeof e<"u"};ze.isEmptyObject=function(e){return Object.keys(e).length===0};ze.merge=function(e,t,r){if(t){let o=Object.keys(t),s=o.length;for(let n=0;n<s;n++)r==="strict"?e[o[n]]=[t[o[n]]]:e[o[n]]=t[o[n]]}};ze.getValue=function(e){return ze.isExist(e)?e:""};ze.isName=Jh;ze.getAllMatches=Yh;ze.nameRegexp=cd});var Jn=P(md=>{"use strict";var Yn=Kn(),Xh={allowBooleanAttributes:!1,unpairedTags:[]};md.validate=function(e,t){t=Object.assign({},Xh,t);let r=[],o=!1,s=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let n=0;n<e.length;n++)if(e[n]==="<"&&e[n+1]==="?"){if(n+=2,n=ld(e,n),n.err)return n}else if(e[n]==="<"){let i=n;if(n++,e[n]==="!"){n=pd(e,n);continue}else{let a=!1;e[n]==="/"&&(a=!0,n++);let c="";for(;n<e.length&&e[n]!==">"&&e[n]!==" "&&e[n]!=="	"&&e[n]!==`
`&&e[n]!=="\r";n++)c+=e[n];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),n--),!ny(c)){let p;return c.trim().length===0?p="Invalid space after '<'.":p="Tag '"+c+"' is an invalid name.",$("InvalidTag",p,se(e,n))}let d=ey(e,n);if(d===!1)return $("InvalidAttr","Attributes for '"+c+"' have open quote.",se(e,n));let l=d.value;if(n=d.index,l[l.length-1]==="/"){let p=n-l.length;l=l.substring(0,l.length-1);let u=ud(l,t);if(u===!0)o=!0;else return $(u.err.code,u.err.msg,se(e,p+u.err.line))}else if(a)if(d.tagClosed){if(l.trim().length>0)return $("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",se(e,i));{let p=r.pop();if(c!==p.tagName){let u=se(e,p.tagStartPos);return $("InvalidTag","Expected closing tag '"+p.tagName+"' (opened in line "+u.line+", col "+u.col+") instead of closing tag '"+c+"'.",se(e,i))}r.length==0&&(s=!0)}}else return $("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",se(e,n));else{let p=ud(l,t);if(p!==!0)return $(p.err.code,p.err.msg,se(e,n-l.length+p.err.line));if(s===!0)return $("InvalidXml","Multiple possible root nodes found.",se(e,n));t.unpairedTags.indexOf(c)!==-1||r.push({tagName:c,tagStartPos:i}),o=!0}for(n++;n<e.length;n++)if(e[n]==="<")if(e[n+1]==="!"){n++,n=pd(e,n);continue}else if(e[n+1]==="?"){if(n=ld(e,++n),n.err)return n}else break;else if(e[n]==="&"){let p=oy(e,n);if(p==-1)return $("InvalidChar","char '&' is not expected.",se(e,n));n=p}else if(s===!0&&!dd(e[n]))return $("InvalidXml","Extra text at the end",se(e,n));e[n]==="<"&&n--}}else{if(dd(e[n]))continue;return $("InvalidChar","char '"+e[n]+"' is not expected.",se(e,n))}if(o){if(r.length==1)return $("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",se(e,r[0].tagStartPos));if(r.length>0)return $("InvalidXml","Invalid '"+JSON.stringify(r.map(n=>n.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return $("InvalidXml","Start tag expected.",1);return!0};function dd(e){return e===" "||e==="	"||e===`
`||e==="\r"}function ld(e,t){let r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let o=e.substr(r,t-r);if(t>5&&o==="xml")return $("InvalidXml","XML declaration allowed only at the start of the document.",se(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function pd(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}var Qh='"',Zh="'";function ey(e,t){let r="",o="",s=!1;for(;t<e.length;t++){if(e[t]===Qh||e[t]===Zh)o===""?o=e[t]:o!==e[t]||(o="");else if(e[t]===">"&&o===""){s=!0;break}r+=e[t]}return o!==""?!1:{value:r,index:t,tagClosed:s}}var ty=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function ud(e,t){let r=Yn.getAllMatches(e,ty),o={};for(let s=0;s<r.length;s++){if(r[s][1].length===0)return $("InvalidAttr","Attribute '"+r[s][2]+"' has no space in starting.",co(r[s]));if(r[s][3]!==void 0&&r[s][4]===void 0)return $("InvalidAttr","Attribute '"+r[s][2]+"' is without value.",co(r[s]));if(r[s][3]===void 0&&!t.allowBooleanAttributes)return $("InvalidAttr","boolean attribute '"+r[s][2]+"' is not allowed.",co(r[s]));let n=r[s][2];if(!sy(n))return $("InvalidAttr","Attribute '"+n+"' is an invalid name.",co(r[s]));if(!o.hasOwnProperty(n))o[n]=1;else return $("InvalidAttr","Attribute '"+n+"' is repeated.",co(r[s]))}return!0}function ry(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function oy(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,ry(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function $(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function sy(e){return Yn.isName(e)}function ny(e){return Yn.isName(e)}function se(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function co(e){return e.startIndex+e[1].length}});var hd=P(Xn=>{var fd={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1},iy=function(e){return Object.assign({},fd,e)};Xn.buildOptions=iy;Xn.defaultOptions=fd});var Ed=P((Ov,yd)=>{"use strict";var Qn=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,[":@"]:t[":@"]}):this.child.push({[t.tagname]:t.child})}};yd.exports=Qn});var wd=P((kv,gd)=>{function ay(e,t){let r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let o=1,s=!1,n=!1,i=!1,a="";for(;t<e.length;t++)if(e[t]==="<"&&!i){if(s&&e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y")t+=7,n=!0;else if(s&&e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T")t+=8;else if(s&&e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T")t+=8;else if(s&&e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N")t+=9;else if(e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-")i=!0;else throw new Error("Invalid DOCTYPE");o++,a=""}else if(e[t]===">"){if(i?e[t-1]==="-"&&e[t-2]==="-"&&(i=!1,o--):(n&&(dy(a,r),n=!1),o--),o===0)break}else e[t]==="["?s=!0:a+=e[t];if(o!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}var cy=RegExp(`^\\s([a-zA-z0-0]+)[ 	](['"])([^&]+)\\2`);function dy(e,t){let r=cy.exec(e);r&&(t[r[1]]={regx:RegExp(`&${r[1]};`,"g"),val:r[3]})}gd.exports=ay});var Sd=P((Dv,xd)=>{var ly=/^[-+]?0x[a-fA-F0-9]+$/,py=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var uy={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function my(e,t={}){if(t=Object.assign({},uy,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(t.hex&&ly.test(r))return Number.parseInt(r,16);{let o=py.exec(r);if(o){let s=o[1],n=o[2],i=fy(o[3]),a=o[4]||o[6];if(!t.leadingZeros&&n.length>0&&s&&r[2]!==".")return e;if(!t.leadingZeros&&n.length>0&&!s&&r[1]!==".")return e;{let c=Number(r),d=""+c;return d.search(/[eE]/)!==-1||a?t.eNotation?c:e:r.indexOf(".")!==-1?d==="0"&&i===""||d===i||s&&d==="-"+i?c:e:n?i===d||s+i===d?c:e:r===d||r===s+d?c:e}}else return e}}function fy(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}xd.exports=my});var bd=P(($v,_d)=>{"use strict";var ri=Kn(),lo=Ed(),hy=wd(),yy=Sd(),Fv="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,ri.nameRegexp),Zn=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=Ey,this.parseXml=_y,this.parseTextData=gy,this.resolveNameSpace=wy,this.buildAttributesMap=Sy,this.isItStopNode=Ty,this.replaceEntitiesValue=by,this.readStopNodeData=Cy,this.saveTextToParentTag=Ry}};function Ey(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let o=t[r];this.lastEntities[o]={regex:new RegExp("&"+o+";","g"),val:e[o]}}}function gy(e,t,r,o,s,n,i){if(e!==void 0&&(this.options.trimValues&&!o&&(e=e.trim()),e.length>0)){i||(e=this.replaceEntitiesValue(e));let a=this.options.tagValueProcessor(t,e,r,s,n);return a==null?e:typeof a!=typeof e||a!==e?a:this.options.trimValues?ti(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?ti(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function wy(e){if(this.options.removeNSPrefix){let t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}var xy=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Sy(e,t){if(!this.options.ignoreAttributes&&typeof e=="string"){let r=ri.getAllMatches(e,xy),o=r.length,s={};for(let n=0;n<o;n++){let i=this.resolveNameSpace(r[n][1]),a=r[n][4],c=this.options.attributeNamePrefix+i;if(i.length)if(this.options.transformAttributeName&&(c=this.options.transformAttributeName(c)),c==="__proto__"&&(c="#__proto__"),a!==void 0){this.options.trimValues&&(a=a.trim()),a=this.replaceEntitiesValue(a);let d=this.options.attributeValueProcessor(i,a,t);d==null?s[c]=a:typeof d!=typeof a||d!==a?s[c]=d:s[c]=ti(a,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[c]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){let n={};return n[this.options.attributesGroupName]=s,n}return s}}var _y=function(e){e=e.replace(/\r\n?/g,`
`);let t=new lo("!xml"),r=t,o="",s="";for(let n=0;n<e.length;n++)if(e[n]==="<")if(e[n+1]==="/"){let a=Mt(e,">",n,"Closing Tag is not closed."),c=e.substring(n+2,a).trim();if(this.options.removeNSPrefix){let d=c.indexOf(":");d!==-1&&(c=c.substr(d+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&(o=this.saveTextToParentTag(o,r,s)),s=s.substr(0,s.lastIndexOf(".")),r=this.tagsNodeStack.pop(),o="",n=a}else if(e[n+1]==="?"){let a=ei(e,n,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(o=this.saveTextToParentTag(o,r,s),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){let c=new lo(a.tagName);c.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(c[":@"]=this.buildAttributesMap(a.tagExp,s)),r.addChild(c)}n=a.closeIndex+1}else if(e.substr(n+1,3)==="!--"){let a=Mt(e,"-->",n+4,"Comment is not closed.");if(this.options.commentPropName){let c=e.substring(n+4,a-2);o=this.saveTextToParentTag(o,r,s),r.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}n=a}else if(e.substr(n+1,2)==="!D"){let a=hy(e,n);this.docTypeEntities=a.entities,n=a.i}else if(e.substr(n+1,2)==="!["){let a=Mt(e,"]]>",n,"CDATA is not closed.")-2,c=e.substring(n+9,a);if(o=this.saveTextToParentTag(o,r,s),this.options.cdataPropName)r.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let d=this.parseTextData(c,r.tagname,s,!0,!1,!0);d==null&&(d=""),r.add(this.options.textNodeName,d)}n=a+2}else{let a=ei(e,n,this.options.removeNSPrefix),c=a.tagName,d=a.tagExp,l=a.attrExpPresent,p=a.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),r&&o&&r.tagname!=="!xml"&&(o=this.saveTextToParentTag(o,r,s,!1)),c!==t.tagname&&(s+=s?"."+c:c);let u=r;if(u&&this.options.unpairedTags.indexOf(u.tagname)!==-1&&(r=this.tagsNodeStack.pop()),this.isItStopNode(this.options.stopNodes,s,c)){let m="";if(d.length>0&&d.lastIndexOf("/")===d.length-1)n=a.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)n=a.closeIndex;else{let h=this.readStopNodeData(e,c,p+1);if(!h)throw new Error(`Unexpected end of ${c}`);n=h.i,m=h.tagContent}let f=new lo(c);c!==d&&l&&(f[":@"]=this.buildAttributesMap(d,s)),m&&(m=this.parseTextData(m,c,s,!0,l,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),f.add(this.options.textNodeName,m),r.addChild(f)}else{if(d.length>0&&d.lastIndexOf("/")===d.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),d=c):d=d.substr(0,d.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));let m=new lo(c);c!==d&&l&&(m[":@"]=this.buildAttributesMap(d,s)),s=s.substr(0,s.lastIndexOf(".")),r.addChild(m)}else{let m=new lo(c);this.tagsNodeStack.push(r),c!==d&&l&&(m[":@"]=this.buildAttributesMap(d,s)),r.addChild(m),r=m}o="",n=p}}else o+=e[n];return t.child},by=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function Ry(e,t,r,o){return e&&(o===void 0&&(o=Object.keys(t.child).length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,o),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function Ty(e,t,r){let o="*."+r;for(let s in e){let n=e[s];if(o===n||t===n)return!0}return!1}function Iy(e,t,r=">"){let o,s="";for(let n=t;n<e.length;n++){let i=e[n];if(o)i===o&&(o="");else if(i==='"'||i==="'")o=i;else if(i===r[0])if(r[1]){if(e[n+1]===r[1])return{data:s,index:n}}else return{data:s,index:n};else i==="	"&&(i=" ");s+=i}}function Mt(e,t,r,o){let s=e.indexOf(t,r);if(s===-1)throw new Error(o);return s+t.length-1}function ei(e,t,r,o=">"){let s=Iy(e,t+1,o);if(!s)return;let n=s.data,i=s.index,a=n.search(/\s/),c=n,d=!0;if(a!==-1&&(c=n.substr(0,a).replace(/\s\s*$/,""),n=n.substr(a+1)),r){let l=c.indexOf(":");l!==-1&&(c=c.substr(l+1),d=c!==s.data.substr(l+1))}return{tagName:c,tagExp:n,closeIndex:i,attrExpPresent:d}}function Cy(e,t,r){let o=r,s=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){let n=Mt(e,">",r,`${t} is not closed`);if(e.substring(r+2,n).trim()===t&&(s--,s===0))return{tagContent:e.substring(o,r),i:n};r=n}else if(e[r+1]==="?")r=Mt(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=Mt(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=Mt(e,"]]>",r,"StopNode is not closed.")-2;else{let n=ei(e,r,">");n&&((n&&n.tagName)===t&&n.tagExp[n.tagExp.length-1]!=="/"&&s++,r=n.closeIndex)}}function ti(e,t,r){if(t&&typeof e=="string"){let o=e.trim();return o==="true"?!0:o==="false"?!1:yy(e,r)}else return ri.isExist(e)?e:""}_d.exports=Zn});var Id=P(Td=>{"use strict";function Py(e,t){return Rd(e,t)}function Rd(e,t,r){let o,s={};for(let n=0;n<e.length;n++){let i=e[n],a=Ay(i),c="";if(r===void 0?c=a:c=r+"."+a,a===t.textNodeName)o===void 0?o=i[a]:o+=""+i[a];else{if(a===void 0)continue;if(i[a]){let d=Rd(i[a],t,c),l=Ny(d,t);i[":@"]?vy(d,i[":@"],c,t):Object.keys(d).length===1&&d[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?d=d[t.textNodeName]:Object.keys(d).length===0&&(t.alwaysCreateTextNode?d[t.textNodeName]="":d=""),s[a]!==void 0&&s.hasOwnProperty(a)?(Array.isArray(s[a])||(s[a]=[s[a]]),s[a].push(d)):t.isArray(a,c,l)?s[a]=[d]:s[a]=d}}}return typeof o=="string"?o.length>0&&(s[t.textNodeName]=o):o!==void 0&&(s[t.textNodeName]=o),s}function Ay(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let o=t[r];if(o!==":@")return o}}function vy(e,t,r,o){if(t){let s=Object.keys(t),n=s.length;for(let i=0;i<n;i++){let a=s[i];o.isArray(a,r+"."+a,!0,!0)?e[a]=[t[a]]:e[a]=t[a]}}}function Ny(e,t){let r=Object.keys(e).length;return!!(r===0||r===1&&e[t.textNodeName])}Td.prettify=Py});var Pd=P((Mv,Cd)=>{var{buildOptions:Oy}=hd(),ky=bd(),{prettify:Dy}=Id(),Fy=Jn(),oi=class{constructor(t){this.externalEntities={},this.options=Oy(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let n=Fy.validate(t,r);if(n!==!0)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}let o=new ky(this.options);o.addExternalEntities(this.externalEntities);let s=o.parseXml(t);return this.options.preserveOrder||s===void 0?s:Dy(s,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}};Cd.exports=oi});var kd=P((Uv,Od)=>{var $y=`
`;function Ly(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=$y),vd(e,t,"",r)}function vd(e,t,r,o){let s="",n=!1;for(let i=0;i<e.length;i++){let a=e[i],c=My(a),d="";if(r.length===0?d=c:d=`${r}.${c}`,c===t.textNodeName){let f=a[c];Uy(d,t)||(f=t.tagValueProcessor(c,f),f=Nd(f,t)),n&&(s+=o),s+=f,n=!1;continue}else if(c===t.cdataPropName){n&&(s+=o),s+=`<![CDATA[${a[c][0][t.textNodeName]}]]>`,n=!1;continue}else if(c===t.commentPropName){s+=o+`<!--${a[c][0][t.textNodeName]}-->`,n=!0;continue}else if(c[0]==="?"){let f=Ad(a[":@"],t),h=c==="?xml"?"":o,E=a[c][0][t.textNodeName];E=E.length!==0?" "+E:"",s+=h+`<${c}${E}${f}?>`,n=!0;continue}let l=o;l!==""&&(l+=t.indentBy);let p=Ad(a[":@"],t),u=o+`<${c}${p}`,m=vd(a[c],t,d,l);t.unpairedTags.indexOf(c)!==-1?t.suppressUnpairedNode?s+=u+">":s+=u+"/>":(!m||m.length===0)&&t.suppressEmptyNode?s+=u+"/>":m&&m.endsWith(">")?s+=u+`>${m}${o}</${c}>`:(s+=u+">",m&&o!==""&&(m.includes("/>")||m.includes("</"))?s+=o+t.indentBy+m+o:s+=m,s+=`</${c}>`),n=!0}return s}function My(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let o=t[r];if(o!==":@")return o}}function Ad(e,t){let r="";if(e&&!t.ignoreAttributes)for(let o in e){let s=t.attributeValueProcessor(o,e[o]);s=Nd(s,t),s===!0&&t.suppressBooleanAttributes?r+=` ${o.substr(t.attributeNamePrefix.length)}`:r+=` ${o.substr(t.attributeNamePrefix.length)}="${s}"`}return r}function Uy(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let o in t.stopNodes)if(t.stopNodes[o]===e||t.stopNodes[o]==="*."+r)return!0;return!1}function Nd(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){let o=t.entities[r];e=e.replace(o.regex,o.val)}return e}Od.exports=Ly});var Fd=P((zv,Dd)=>{"use strict";var zy=kd(),qy={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[]};function _t(e){this.options=Object.assign({},qy,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Gy),this.processTextOrObjNode=By,this.options.format?(this.indentate=jy,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}_t.prototype.build=function(e){return this.options.preserveOrder?zy(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};_t.prototype.j2x=function(e,t){let r="",o="";for(let s in e)if(!(typeof e[s]>"u"))if(e[s]===null)s[0]==="?"?o+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(e[s]instanceof Date)o+=this.buildTextValNode(e[s],s,"",t);else if(typeof e[s]!="object"){let n=this.isAttribute(s);if(n)r+=this.buildAttrPairStr(n,""+e[s]);else if(s===this.options.textNodeName){let i=this.options.tagValueProcessor(s,""+e[s]);o+=this.replaceEntitiesValue(i)}else o+=this.buildTextValNode(e[s],s,"",t)}else if(Array.isArray(e[s])){let n=e[s].length;for(let i=0;i<n;i++){let a=e[s][i];typeof a>"u"||(a===null?s[0]==="?"?o+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+s+"/"+this.tagEndChar:typeof a=="object"?o+=this.processTextOrObjNode(a,s,t):o+=this.buildTextValNode(a,s,"",t))}}else if(this.options.attributesGroupName&&s===this.options.attributesGroupName){let n=Object.keys(e[s]),i=n.length;for(let a=0;a<i;a++)r+=this.buildAttrPairStr(n[a],""+e[s][n[a]])}else o+=this.processTextOrObjNode(e[s],s,t);return{attrStr:r,val:o}};_t.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function By(e,t,r){let o=this.j2x(e,r+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,o.attrStr,r):this.buildObjectNode(o.val,t,o.attrStr,r)}_t.prototype.buildObjectNode=function(e,t,r,o){if(e==="")return t[0]==="?"?this.indentate(o)+"<"+t+r+"?"+this.tagEndChar:this.indentate(o)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let s="</"+t+this.tagEndChar,n="";return t[0]==="?"&&(n="?",s=""),r&&e.indexOf("<")===-1?this.indentate(o)+"<"+t+r+n+">"+e+s:this.options.commentPropName!==!1&&t===this.options.commentPropName&&n.length===0?this.indentate(o)+`<!--${e}-->`+this.newLine:this.indentate(o)+"<"+t+r+n+this.tagEndChar+e+this.indentate(o)+s}};_t.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};_t.prototype.buildTextValNode=function(e,t,r,o){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(o)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(o)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(o)+"<"+t+r+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(t,e);return s=this.replaceEntitiesValue(s),s===""?this.indentate(o)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(o)+"<"+t+r+">"+s+"</"+t+this.tagEndChar}};_t.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){let r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};function jy(e){return this.options.indentBy.repeat(e)}function Gy(e){return e.startsWith(this.options.attributeNamePrefix)?e.substr(this.attrPrefixLen):!1}Dd.exports=_t});var Ld=P((qv,$d)=>{"use strict";var Vy=Jn(),Hy=Pd(),Wy=Fd();$d.exports={XMLParser:Hy,XMLValidator:Vy,XMLBuilder:Wy}});var N=vi(on(),1);import{execFileSync as Co}from"node:child_process";import{join as _w}from"node:path";import{cwd as bw}from"node:process";import{inspect as Ci}from"node:util";var xe=class{trace(){}debug(){}info(){}warn(){}error(){}};var Zt=()=>{let e=[],t=[],r=new Set,o=l=>l.sort((p,u)=>Ca[u.step]-Ca[p.step]||Pa[u.priority||"normal"]-Pa[p.priority||"normal"]),s=l=>{let p=!1,u=m=>m.name&&m.name===l?(p=!0,r.delete(l),!1):!0;return e=e.filter(u),t=t.filter(u),p},n=l=>{let p=!1,u=m=>m.middleware===l?(p=!0,m.name&&r.delete(m.name),!1):!0;return e=e.filter(u),t=t.filter(u),p},i=l=>(e.forEach(p=>{l.add(p.middleware,{...p})}),t.forEach(p=>{l.addRelativeTo(p.middleware,{...p})}),l),a=l=>{let p=[];return l.before.forEach(u=>{u.before.length===0&&u.after.length===0?p.push(u):p.push(...a(u))}),p.push(l),l.after.reverse().forEach(u=>{u.before.length===0&&u.after.length===0?p.push(u):p.push(...a(u))}),p},c=(l=!1)=>{let p=[],u=[],m={};return e.forEach(h=>{let E={...h,before:[],after:[]};E.name&&(m[E.name]=E),p.push(E)}),t.forEach(h=>{let E={...h,before:[],after:[]};E.name&&(m[E.name]=E),u.push(E)}),u.forEach(h=>{if(h.toMiddleware){let E=m[h.toMiddleware];if(E===void 0){if(l)return;throw new Error(`${h.toMiddleware} is not found when adding ${h.name||"anonymous"} middleware ${h.relation} ${h.toMiddleware}`)}h.relation==="after"&&E.after.push(h),h.relation==="before"&&E.before.push(h)}}),o(p).map(a).reduce((h,E)=>(h.push(...E),h),[])},d={add:(l,p={})=>{let{name:u,override:m}=p,f={step:"initialize",priority:"normal",middleware:l,...p};if(u){if(r.has(u)){if(!m)throw new Error(`Duplicate middleware name '${u}'`);let h=e.findIndex(ie=>ie.name===u),E=e[h];if(E.step!==f.step||E.priority!==f.priority)throw new Error(`"${u}" middleware with ${E.priority} priority in ${E.step} step cannot be overridden by same-name middleware with ${f.priority} priority in ${f.step} step.`);e.splice(h,1)}r.add(u)}e.push(f)},addRelativeTo:(l,p)=>{let{name:u,override:m}=p,f={middleware:l,...p};if(u){if(r.has(u)){if(!m)throw new Error(`Duplicate middleware name '${u}'`);let h=t.findIndex(ie=>ie.name===u),E=t[h];if(E.toMiddleware!==f.toMiddleware||E.relation!==f.relation)throw new Error(`"${u}" middleware ${E.relation} "${E.toMiddleware}" middleware cannot be overridden by same-name middleware ${f.relation} "${f.toMiddleware}" middleware.`);t.splice(h,1)}r.add(u)}t.push(f)},clone:()=>i(Zt()),use:l=>{l.applyToStack(d)},remove:l=>typeof l=="string"?s(l):n(l),removeByTag:l=>{let p=!1,u=m=>{let{tags:f,name:h}=m;return f&&f.includes(l)?(h&&r.delete(h),p=!0,!1):!0};return e=e.filter(u),t=t.filter(u),p},concat:l=>{let p=i(Zt());return p.use(l),p},applyToStack:i,identify:()=>c(!0).map(l=>l.name+": "+(l.tags||[]).join(",")),resolve:(l,p)=>{for(let u of c().map(m=>m.middleware).reverse())l=u(l,p);return l}};return d},Ca={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},Pa={high:3,normal:2,low:1};var Se=class{constructor(t){this.middlewareStack=Zt(),this.config=t}send(t,r,o){let s=typeof r!="function"?r:void 0,n=typeof r=="function"?r:o,i=t.resolveMiddleware(this.middlewareStack,this.config,s);if(n)i(t).then(a=>n(null,a.output),a=>n(a)).catch(()=>{});else return i(t).then(a=>a.output)}destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}};var H=class{constructor(){this.middlewareStack=Zt()}};var Bo="***SensitiveInformation***";var eo=e=>{if(e!=null){if(typeof e=="string"){let t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&La.warn($a(`Expected number but observed string: ${e}`)),t}if(typeof e=="number")return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}},uf=Math.ceil(34028234663852886e22),Aa=e=>{let t=eo(e);if(t!==void 0&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>uf)throw new TypeError(`Expected 32-bit float, got ${e}`);return t},pn=e=>{if(e!=null){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}};var to=e=>un(e,32),va=e=>un(e,16),Na=e=>un(e,8),un=(e,t)=>{let r=pn(e);if(r!==void 0&&mf(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},mf=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},_e=(e,t)=>{if(e==null)throw t?new TypeError(`Expected a non-null value for ${t}`):new TypeError("Expected a non-null value");return e},jo=e=>{if(e==null)return;if(typeof e=="object"&&!Array.isArray(e))return e;let t=Array.isArray(e)?"array":typeof e;throw new TypeError(`Expected object, got ${t}: ${e}`)},g=e=>{if(e!=null){if(typeof e=="string")return e;if(["boolean","number","bigint"].includes(typeof e))return La.warn($a(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}};var Oa=e=>eo(typeof e=="string"?ro(e):e);var ka=e=>Aa(typeof e=="string"?ro(e):e),ff=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,ro=e=>{let t=e.match(ff);if(t===null||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)};var mn=e=>to(typeof e=="string"?ro(e):e),Da=e=>va(typeof e=="string"?ro(e):e),Fa=e=>Na(typeof e=="string"?ro(e):e),$a=e=>String(new TypeError(e).stack||e).split(`
`).slice(0,5).filter(t=>!t.includes("stackTraceWarning")).join(`
`),La={warn:console.warn};var hf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var Mx=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/);var yf=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),Ma=e=>{if(e==null)return;if(typeof e!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");let t=yf.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");let[r,o,s,n,i,a,c,d,l]=t,p=Da(za(o)),u=oo(s,"month",1,12),m=oo(n,"day",1,31),f=Ef(p,u,m,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:d});return l.toUpperCase()!="Z"&&f.setTime(f.getTime()-_f(l)),f},Ux=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),zx=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),qx=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/);var Ua=e=>{if(e==null)return;let t;if(typeof e=="number")t=e;else if(typeof e=="string")t=Oa(e);else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(t)||t===1/0||t===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(t*1e3))},Ef=(e,t,r,o)=>{let s=t-1;return wf(e,s,r),new Date(Date.UTC(e,s,r,oo(o.hours,"hour",0,23),oo(o.minutes,"minute",0,59),oo(o.seconds,"seconds",0,60),Sf(o.fractionalMilliseconds)))};var Bx=50*365*24*60*60*1e3;var gf=[31,28,31,30,31,30,31,31,30,31,30,31],wf=(e,t,r)=>{let o=gf[t];if(t===1&&xf(e)&&(o=29),r>o)throw new TypeError(`Invalid day for ${hf[t]} in ${e}: ${r}`)},xf=e=>e%4===0&&(e%100!==0||e%400===0),oo=(e,t,r,o)=>{let s=Fa(za(e));if(s<r||s>o)throw new TypeError(`${t} must be between ${r} and ${o}, inclusive`);return s},Sf=e=>e==null?0:ka("0."+e)*1e3,_f=e=>{let t=e[0],r=1;if(t=="+")r=1;else if(t=="-")r=-1;else throw new TypeError(`Offset direction, ${t}, must be "+" or "-"`);let o=Number(e.substring(1,3)),s=Number(e.substring(4,6));return r*(o*60+s)*60*1e3},za=e=>{let t=0;for(;t<e.length-1&&e.charAt(t)==="0";)t++;return t===0?e:e.slice(t)};var ue=class extends Error{constructor(t){super(t.message),Object.setPrototypeOf(this,ue.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}},S=(e,t={})=>{Object.entries(t).filter(([,o])=>o!==void 0).forEach(([o,s])=>{(e[o]==null||e[o]==="")&&(e[o]=s)});let r=e.message||e.Message||"UnknownError";return e.message=r,delete e.Message,e};var bf=({output:e,parsedBody:t,exceptionCtor:r,errorCode:o})=>{let s=Rf(e),n=s.httpStatusCode?s.httpStatusCode+"":void 0,i=new r({name:(t==null?void 0:t.code)||(t==null?void 0:t.Code)||o||n||"UnknownError",$fault:"client",$metadata:s});throw S(i,t)},Ze=e=>({output:t,parsedBody:r,errorCode:o})=>{bf({output:t,parsedBody:r,exceptionCtor:e,errorCode:o})},Rf=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});var et=e=>{switch(e){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}};var qa=!1,tt=e=>{e&&!qa&&parseInt(e.substring(1,e.indexOf(".")))<14&&(qa=!0)};function Go(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var fn=e=>{let t="#text";for(let r in e)e.hasOwnProperty(r)&&e[r][t]!==void 0?e[r]=e[r][t]:typeof e[r]=="object"&&e[r]!==null&&(e[r]=fn(e[r]));return e};var hn=function(){let e=Object.getPrototypeOf(this).constructor,t=Function.bind.apply(String,[null,...arguments]),r=new t;return Object.setPrototypeOf(r,e.prototype),r};hn.prototype=Object.create(String.prototype,{constructor:{value:hn,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(hn,String);function O(e,t,r){let o,s,n;if(typeof t>"u"&&typeof r>"u")o={},n=e;else{if(o=e,typeof t=="function")return s=t,n=r,Tf(o,s,n);n=t}for(let i of Object.keys(n)){if(!Array.isArray(n[i])){o[i]=n[i];continue}Ba(o,null,n,i)}return o}var v=(e,t)=>{let r={};for(let o in t)Ba(r,e,t,o);return r},Tf=(e,t,r)=>O(e,Object.entries(r).reduce((o,[s,n])=>(Array.isArray(n)?o[s]=n:typeof n=="function"?o[s]=[t,n()]:o[s]=[t,n],o),{})),Ba=(e,t,r,o)=>{if(t!==null){let i=r[o];typeof i=="function"&&(i=[,i]);let[a=If,c=Cf,d=o]=i;(typeof a=="function"&&a(t[d])||typeof a!="function"&&a)&&(e[o]=c(t[d]));return}let[s,n]=r[o];if(typeof n=="function"){let i,a=s===void 0&&(i=n())!=null,c=typeof s=="function"&&!!s(void 0)||typeof s!="function"&&!!s;a?e[o]=i:c&&(e[o]=n())}else{let i=s===void 0&&n!=null,a=typeof s=="function"&&!!s(n)||typeof s!="function"&&!!s;(i||a)&&(e[o]=n)}},If=e=>e!=null,Cf=e=>e;var D=e=>{if(e==null)return{};if(Array.isArray(e))return e.filter(t=>t!=null);if(typeof e=="object"){let t={};for(let r of Object.keys(e))e[r]!=null&&(t[r]=D(e[r]));return t}return e};var ja=async e=>{let t=(e==null?void 0:e.Bucket)||"";if(typeof e.Bucket=="string"&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Of(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!Nf(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},Pf=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,Af=/(\d+\.){3}\d+/,vf=/\.\./;var Nf=e=>Pf.test(e)&&!Af.test(e)&&!vf.test(e),Of=e=>{let[t,r,o,s,n,i]=e.split(":"),a=t==="arn"&&e.split(":").length>=6,c=[t,r,o,n,i].filter(Boolean).length===5;if(a&&!c)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return t==="arn"&&!!r&&!!o&&!!n&&!!i};var Ga=(e,t,r)=>{let o=async()=>{let s=r[e]??r[t];return typeof s=="function"?s():s};return e==="endpoint"||t==="endpoint"?async()=>{let s=await o();if(s&&typeof s=="object"){if("url"in s)return s.url.href;if("hostname"in s){let{protocol:n,hostname:i,port:a,path:c}=s;return`${n}//${i}${a?":"+a:""}${c}`}}return s}:o};var Va=async(e,t,r,o)=>{let s=await kf(e,t,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(s,o)},kf=async(e,t,r)=>{var n;let o={},s=((n=t==null?void 0:t.getEndpointParameterInstructions)==null?void 0:n.call(t))||{};for(let[i,a]of Object.entries(s))switch(a.type){case"staticContextParams":o[i]=a.value;break;case"contextParams":o[i]=e[a.name];break;case"clientContextParams":case"builtInParams":o[i]=await Ga(a.name,i,r)();break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(a))}return Object.keys(s).length===0&&Object.assign(o,r),String(r.serviceId).toLowerCase()==="s3"&&await ja(o),o};function Ha(e){let t={};if(e=e.replace(/^\?/,""),e)for(let r of e.split("&")){let[o,s=null]=r.split("=");o=decodeURIComponent(o),s&&(s=decodeURIComponent(s)),o in t?Array.isArray(t[o])?t[o].push(s):t[o]=[t[o],s]:t[o]=s}return t}var Z=e=>{if(typeof e=="string")return Z(new URL(e));let{hostname:t,pathname:r,port:o,protocol:s,search:n}=e,i;return n&&(i=Ha(n)),{hostname:t,port:o?parseInt(o):void 0,protocol:s,path:r,query:i}};var Wa=e=>typeof e=="object"?"url"in e?Z(e.url):e:Z(e);var Ka=({config:e,instructions:t})=>(r,o)=>async s=>{var a,c;let n=await Va(s.input,{getEndpointParameterInstructions(){return t}},{...e},o);o.endpointV2=n,o.authSchemes=(a=n.properties)==null?void 0:a.authSchemes;let i=(c=o.authSchemes)==null?void 0:c[0];return i&&(o.signing_region=i.signingRegion,o.signing_service=i.signingName),r({...s})};var Ya=(e,t)=>(r,o)=>async s=>{let{response:n}=await r(s);try{let i=await t(n,e);return{response:n,output:i}}catch(i){if(Object.defineProperty(i,"$response",{value:n}),!("$metadata"in i)){let a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";i.message+=`
  `+a}throw i}};var Ja=(e,t)=>(r,o)=>async s=>{var a;let n=(a=o.endpointV2)!=null&&a.url&&e.urlParser?async()=>e.urlParser(o.endpointV2.url):e.endpoint;if(!n)throw new Error("No valid endpoint provider available.");let i=await t(s.input,{...e,endpoint:n});return r({...s,request:i})};var Df={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},yn={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function ee(e,t,r){return{applyToStack:o=>{o.add(Ya(e,r),Df),o.add(Ja(e,t),yn)}}}var Ff={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:yn.name},te=(e,t)=>({applyToStack:r=>{r.addRelativeTo(Ka({config:e,instructions:t}),Ff)}});var B=e=>{if(typeof e=="function")return e;let t=Promise.resolve(e);return()=>t};var rt=e=>{let t=e.tls??!0,{endpoint:r}=e,o=r!=null?async()=>Wa(await B(r)()):void 0;return{...e,endpoint:o,tls:t,isCustomEndpoint:!!r,useDualstackEndpoint:B(e.useDualstackEndpoint??!1),useFipsEndpoint:B(e.useFipsEndpoint??!1)}};var En;(function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"})(En||(En={}));var I=class{constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/"}static isInstance(t){if(!t)return!1;let r=t;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){let t=new I({...this,headers:{...this.headers}});return t.query&&(t.query=$f(t.query)),t}};function $f(e){return Object.keys(e).reduce((t,r)=>{let o=e[r];return{...t,[r]:Array.isArray(o)?[...o]:o}},{})}var be=class{constructor(t){this.statusCode=t.statusCode,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;let r=t;return typeof r.statusCode=="number"&&typeof r.headers=="object"}};var j=class extends ue{constructor(t){super(t),Object.setPrototypeOf(this,j.prototype)}};var er=class extends j{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t}),this.name="InvalidParameterException",this.$fault="client",Object.setPrototypeOf(this,er.prototype)}},tr=class extends j{constructor(t){super({name:"RepositoryNotFoundException",$fault:"client",...t}),this.name="RepositoryNotFoundException",this.$fault="client",Object.setPrototypeOf(this,tr.prototype)}},rr=class extends j{constructor(t){super({name:"ServerException",$fault:"server",...t}),this.name="ServerException",this.$fault="server",Object.setPrototypeOf(this,rr.prototype)}};var or=class extends j{constructor(t){super({name:"KmsException",$fault:"client",...t}),this.name="KmsException",this.$fault="client",Object.setPrototypeOf(this,or.prototype),this.kmsError=t.kmsError}};var sr=class extends j{constructor(t){super({name:"LimitExceededException",$fault:"client",...t}),this.name="LimitExceededException",this.$fault="client",Object.setPrototypeOf(this,sr.prototype)}};var nr=class extends j{constructor(t){super({name:"LayersNotFoundException",$fault:"client",...t}),this.name="LayersNotFoundException",this.$fault="client",Object.setPrototypeOf(this,nr.prototype)}};var ir=class extends j{constructor(t){super({name:"ImageAlreadyExistsException",$fault:"client",...t}),this.name="ImageAlreadyExistsException",this.$fault="client",Object.setPrototypeOf(this,ir.prototype)}},ar=class extends j{constructor(t){super({name:"ImageDigestDoesNotMatchException",$fault:"client",...t}),this.name="ImageDigestDoesNotMatchException",this.$fault="client",Object.setPrototypeOf(this,ar.prototype)}},cr=class extends j{constructor(t){super({name:"ImageTagAlreadyExistsException",$fault:"client",...t}),this.name="ImageTagAlreadyExistsException",this.$fault="client",Object.setPrototypeOf(this,cr.prototype)}},dr=class extends j{constructor(t){super({name:"ReferencedImagesNotFoundException",$fault:"client",...t}),this.name="ReferencedImagesNotFoundException",this.$fault="client",Object.setPrototypeOf(this,dr.prototype)}};var Xa=async(e,t)=>{let r=_n("BatchGetImage"),o;return o=JSON.stringify(D(e)),Sn(t,r,"/",void 0,o)};var Qa=async(e,t)=>{let r=_n("GetAuthorizationToken"),o;return o=JSON.stringify(D(e)),Sn(t,r,"/",void 0,o)};var Za=async(e,t)=>{let r=_n("PutImage"),o;return o=JSON.stringify(D(e)),Sn(t,r,"/",void 0,o)};var ec=async(e,t)=>{if(e.statusCode>=300)return Lf(e,t);let r=await Vo(e.body,t),o={};return o=D(r),{$metadata:ae(e),...o}},Lf=async(e,t)=>{let r={...e,body:await bn(e.body,t)},o=Rn(e,r.body);switch(o){case"InvalidParameterException":case"com.amazonaws.ecr#InvalidParameterException":throw await gn(r,t);case"RepositoryNotFoundException":case"com.amazonaws.ecr#RepositoryNotFoundException":throw await oc(r,t);case"ServerException":case"com.amazonaws.ecr#ServerException":throw await wn(r,t);default:let s=r.body;return xn({output:e,parsedBody:s,errorCode:o})}};var tc=async(e,t)=>{if(e.statusCode>=300)return Mf(e,t);let r=await Vo(e.body,t),o={};return o=Yf(r,t),{$metadata:ae(e),...o}},Mf=async(e,t)=>{let r={...e,body:await bn(e.body,t)},o=Rn(e,r.body);switch(o){case"InvalidParameterException":case"com.amazonaws.ecr#InvalidParameterException":throw await gn(r,t);case"ServerException":case"com.amazonaws.ecr#ServerException":throw await wn(r,t);default:let s=r.body;return xn({output:e,parsedBody:s,errorCode:o})}};var rc=async(e,t)=>{if(e.statusCode>=300)return Uf(e,t);let r=await Vo(e.body,t),o={};return o=D(r),{$metadata:ae(e),...o}},Uf=async(e,t)=>{let r={...e,body:await bn(e.body,t)},o=Rn(e,r.body);switch(o){case"ImageAlreadyExistsException":case"com.amazonaws.ecr#ImageAlreadyExistsException":throw await zf(r,t);case"ImageDigestDoesNotMatchException":case"com.amazonaws.ecr#ImageDigestDoesNotMatchException":throw await qf(r,t);case"ImageTagAlreadyExistsException":case"com.amazonaws.ecr#ImageTagAlreadyExistsException":throw await Bf(r,t);case"InvalidParameterException":case"com.amazonaws.ecr#InvalidParameterException":throw await gn(r,t);case"KmsException":case"com.amazonaws.ecr#KmsException":throw await jf(r,t);case"LayersNotFoundException":case"com.amazonaws.ecr#LayersNotFoundException":throw await Gf(r,t);case"LimitExceededException":case"com.amazonaws.ecr#LimitExceededException":throw await Vf(r,t);case"ReferencedImagesNotFoundException":case"com.amazonaws.ecr#ReferencedImagesNotFoundException":throw await Hf(r,t);case"RepositoryNotFoundException":case"com.amazonaws.ecr#RepositoryNotFoundException":throw await oc(r,t);case"ServerException":case"com.amazonaws.ecr#ServerException":throw await wn(r,t);default:let s=r.body;return xn({output:e,parsedBody:s,errorCode:o})}};var zf=async(e,t)=>{let r=e.body,o=D(r),s=new ir({$metadata:ae(e),...o});return S(s,r)},qf=async(e,t)=>{let r=e.body,o=D(r),s=new ar({$metadata:ae(e),...o});return S(s,r)};var Bf=async(e,t)=>{let r=e.body,o=D(r),s=new cr({$metadata:ae(e),...o});return S(s,r)};var gn=async(e,t)=>{let r=e.body,o=D(r),s=new er({$metadata:ae(e),...o});return S(s,r)};var jf=async(e,t)=>{let r=e.body,o=D(r),s=new or({$metadata:ae(e),...o});return S(s,r)};var Gf=async(e,t)=>{let r=e.body,o=D(r),s=new nr({$metadata:ae(e),...o});return S(s,r)};var Vf=async(e,t)=>{let r=e.body,o=D(r),s=new sr({$metadata:ae(e),...o});return S(s,r)};var Hf=async(e,t)=>{let r=e.body,o=D(r),s=new dr({$metadata:ae(e),...o});return S(s,r)};var oc=async(e,t)=>{let r=e.body,o=D(r),s=new tr({$metadata:ae(e),...o});return S(s,r)};var wn=async(e,t)=>{let r=e.body,o=D(r),s=new rr({$metadata:ae(e),...o});return S(s,r)};var Wf=(e,t)=>v(e,{authorizationToken:g,expiresAt:r=>_e(Ua(eo(r))),proxyEndpoint:g}),Kf=(e,t)=>(e||[]).filter(o=>o!=null).map(o=>Wf(o,t));var Yf=(e,t)=>v(e,{authorizationData:r=>Kf(r,t)});var ae=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Jf=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),Xf=(e,t)=>Jf(e,t).then(r=>t.utf8Encoder(r)),xn=Ze(j),Sn=async(e,t,r,o,s)=>{let{hostname:n,protocol:i="https",port:a,path:c}=await e.endpoint(),d={protocol:i,hostname:n,port:a,method:"POST",path:c.endsWith("/")?c.slice(0,-1)+r:c+r,headers:t};return o!==void 0&&(d.hostname=o),s!==void 0&&(d.body=s),new I(d)};function _n(e){return{"content-type":"application/x-amz-json-1.1","x-amz-target":`AmazonEC2ContainerRegistry_V20150921.${e}`}}var Vo=(e,t)=>Xf(e,t).then(r=>r.length?JSON.parse(r):{}),bn=async(e,t)=>{let r=await Vo(e,t);return r.message=r.message??r.Message,r},Rn=(e,t)=>{let r=(n,i)=>Object.keys(n).find(a=>a.toLowerCase()===i.toLowerCase()),o=n=>{let i=n;return typeof i=="number"&&(i=i.toString()),i.indexOf(",")>=0&&(i=i.split(",")[0]),i.indexOf(":")>=0&&(i=i.split(":")[0]),i.indexOf("#")>=0&&(i=i.split("#")[1]),i},s=r(e.headers,"x-amzn-errortype");if(s!==void 0)return o(e.headers[s]);if(t.code!==void 0)return o(t.code);if(t.__type!==void 0)return o(t.__type)};var lr=class extends H{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,lr.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"ECRClient",commandName:"BatchGetImageCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return Xa(t,r)}deserialize(t,r){return ec(t,r)}};var pr=class extends H{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,pr.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"ECRClient",commandName:"GetAuthorizationTokenCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return Qa(t,r)}deserialize(t,r){return tc(t,r)}};var ur=class extends H{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,ur.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"ECRClient",commandName:"PutImageCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return Za(t,r)}deserialize(t,r){return rc(t,r)}};var ot;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(ot||(ot={}));var mr=(e,t,r)=>{if(t in e){if(e[t]==="true")return!0;if(e[t]==="false")return!1;throw new Error(`Cannot load ${r} "${t}". Expected "true" or "false", got ${e[t]}.`)}};var Qf="AWS_USE_DUALSTACK_ENDPOINT",Zf="use_dualstack_endpoint";var st={environmentVariableSelector:e=>mr(e,Qf,ot.ENV),configFileSelector:e=>mr(e,Zf,ot.CONFIG),default:!1};var eh="AWS_USE_FIPS_ENDPOINT",th="use_fips_endpoint";var nt={environmentVariableSelector:e=>mr(e,eh,ot.ENV),configFileSelector:e=>mr(e,th,ot.CONFIG),default:!1};var rh="AWS_REGION",oh="region",Re={environmentVariableSelector:e=>e[rh],configFileSelector:e=>e[oh],default:()=>{throw new Error("Region is missing")}},it={preferredFile:"credentials"};var Ho=e=>typeof e=="string"&&(e.startsWith("fips-")||e.endsWith("-fips"));var Tn=e=>Ho(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e;var at=e=>{let{region:t,useFipsEndpoint:r}=e;if(!t)throw new Error("Region is missing");return{...e,region:async()=>{if(typeof t=="string")return Tn(t);let o=await t();return Tn(o)},useFipsEndpoint:async()=>{let o=typeof t=="string"?t:await t();return Ho(o)?!0:typeof r!="function"?Promise.resolve(!!r):r()}}};var sc="content-length";function sh(e){return t=>async r=>{let o=r.request;if(I.isInstance(o)){let{body:s,headers:n}=o;if(s&&Object.keys(n).map(i=>i.toLowerCase()).indexOf(sc)===-1)try{let i=e(s);o.headers={...o.headers,[sc]:String(i)}}catch{}}return t({...r,request:o})}}var nh={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},ct=e=>({applyToStack:t=>{t.add(sh(e.bodyLengthChecker),nh)}});var ih=e=>t=>async r=>{if(!I.isInstance(r.request))return t(r);let{request:o}=r,{handlerProtocol:s=""}=e.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!o.headers[":authority"])delete o.headers.host,o.headers[":authority"]="";else if(!o.headers.host){let n=o.hostname;o.port!=null&&(n+=`:${o.port}`),o.headers.host=n}return t(r)},ah={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},dt=e=>({applyToStack:t=>{t.add(ih(e),ah)}});var ch=()=>(e,t)=>async r=>{var o,s;try{let n=await e(r),{clientName:i,commandName:a,logger:c,dynamoDbDocumentClientOptions:d={}}=t,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:p}=d,u=l??t.inputFilterSensitiveLog,m=p??t.outputFilterSensitiveLog,{$metadata:f,...h}=n.output;return(o=c==null?void 0:c.info)==null||o.call(c,{clientName:i,commandName:a,input:u(r.input),output:m(h),metadata:f}),n}catch(n){let{clientName:i,commandName:a,logger:c,dynamoDbDocumentClientOptions:d={}}=t,{overrideInputFilterSensitiveLog:l}=d,p=l??t.inputFilterSensitiveLog;throw(s=c==null?void 0:c.error)==null||s.call(c,{clientName:i,commandName:a,input:p(r.input),error:n,metadata:n.$metadata}),n}},dh={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},lt=e=>({applyToStack:t=>{t.add(ch(),dh)}});var nc="X-Amzn-Trace-Id",lh="AWS_LAMBDA_FUNCTION_NAME",ph="_X_AMZN_TRACE_ID",uh=e=>t=>async r=>{let{request:o}=r;if(!I.isInstance(o)||e.runtime!=="node"||o.headers.hasOwnProperty(nc))return t(r);let s=process.env[lh],n=process.env[ph],i=a=>typeof a=="string"&&a.length>0;return i(s)&&i(n)&&(o.headers[nc]=n),t({...r,request:o})},mh={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},pt=e=>({applyToStack:t=>{t.add(uh(e),mh)}});var Te;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(Te||(Te={}));var $t=3,Ie="STANDARD";var ic=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],ac=["AbortError","TimeoutError","RequestTimeout","RequestTimeoutException"],cc=[500,502,503,504],dc=["ECONNRESET","EPIPE","ETIMEDOUT"];var fr=e=>{var t,r;return((t=e.$metadata)==null?void 0:t.httpStatusCode)===429||ic.includes(e.name)||((r=e.$retryable)==null?void 0:r.throttling)==!0},Wo=e=>{var t;return ac.includes(e.name)||dc.includes((e==null?void 0:e.code)||"")||cc.includes(((t=e.$metadata)==null?void 0:t.httpStatusCode)||0)},lc=e=>{var t;if(((t=e.$metadata)==null?void 0:t.httpStatusCode)!==void 0){let r=e.$metadata.httpStatusCode;return 500<=r&&r<=599&&!Wo(e)}return!1};var so=class{constructor(t){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=(t==null?void 0:t.beta)??.7,this.minCapacity=(t==null?void 0:t.minCapacity)??1,this.minFillRate=(t==null?void 0:t.minFillRate)??.5,this.scaleConstant=(t==null?void 0:t.scaleConstant)??.4,this.smooth=(t==null?void 0:t.smooth)??.8;let r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){let r=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(o=>setTimeout(o,r))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){let t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}let r=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=t}updateClientSendingRate(t){let r;if(this.updateMeasuredRate(),fr(t)){let s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());let o=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(o)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let t=this.getCurrentTimeInSeconds(),r=Math.floor(t*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){let o=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(o*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(t){return parseFloat(t.toFixed(8))}};var Ko="amz-sdk-invocation-id",Yo="amz-sdk-request";var pc=()=>{let e=100;return{computeNextBackoffDelay:o=>Math.floor(Math.min(2e4,Math.random()*2**o*e)),setDelayBase:o=>{e=o}}};var yc=(e,t,r,o)=>{let s=e,n=(o==null?void 0:o.retryCost)??5,i=(o==null?void 0:o.timeoutRetryCost)??10,a=(o==null?void 0:o.retryBackoffStrategy)??pc(),c=e,d=Math.min(2e4,t),l,p=r??0,u=J=>J==="TRANSIENT"?i:n,m=()=>p,f=()=>d,h=()=>l,E=J=>u(J)<=c;return{getRetryCount:m,getRetryDelay:f,getLastRetryCost:h,hasRetryTokens:E,getRetryTokenCount:J=>{let Vt=J.errorType;if(!E(Vt))throw new Error("No retry token available");let Ht=u(Vt),Po=Vt==="THROTTLING"?500:100;a.setDelayBase(Po);let Dt=a.computeNextBackoffDelay(p);if(J.retryAfterHint){let Ao=J.retryAfterHint.getTime()-Date.now();d=Math.max(Ao||0,Dt)}else d=Dt;return p++,l=Ht,c-=Ht,Ht},releaseRetryTokens:J=>{c+=J??1,c=Math.min(c,s)}}};var yr=class{constructor(t){this.maxAttemptsProvider=t,this.mode=Te.STANDARD,this.retryToken=yc(500,100),this.maxAttemptsProvider=t}async acquireInitialRetryToken(t){return this.retryToken}async refreshRetryTokenForRetry(t,r){let o=await this.getMaxAttempts();if(this.shouldRetry(t,r,o))return t.getRetryTokenCount(r),t;throw new Error("No retry token available")}recordSuccess(t){this.retryToken.releaseRetryTokens(t.getLastRetryCost())}async getMaxAttempts(){let t;try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${$t}`),$t}}shouldRetry(t,r,o){return t.getRetryCount()<o&&t.hasRetryTokens(r.errorType)&&this.isRetryableError(r.errorType)}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}};var Xo=class{constructor(t,r){this.maxAttemptsProvider=t,this.mode=Te.ADAPTIVE;let{rateLimiter:o}=r??{};this.rateLimiter=o??new so,this.standardRetryStrategy=new yr(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(t,r)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}};var In=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`);var gc="AWS_MAX_ATTEMPTS",wc="max_attempts",ut={environmentVariableSelector:e=>{let t=e[gc];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Environment variable ${gc} mast be a number, got "${t}"`);return r},configFileSelector:e=>{let t=e[wc];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Shared config file entry ${wc} mast be a number, got "${t}"`);return r},default:$t},mt=e=>{let{retryStrategy:t}=e,r=B(e.maxAttempts??$t);return{...e,maxAttempts:r,retryStrategy:async()=>t||(await B(e.retryMode)()===Te.ADAPTIVE?new Xo(r):new yr(r))}},fh="AWS_RETRY_MODE",hh="retry_mode",ft={environmentVariableSelector:e=>e[fh],configFileSelector:e=>e[hh],default:Ie};Ws();var yh=e=>(t,r)=>async o=>{let s=await e.retryStrategy(),n=await e.maxAttempts();if(Eh(s)){s=s;let i=await s.acquireInitialRetryToken(r.partition_id),a=new Error,c=0,d=0,{request:l}=o;for(I.isInstance(l)&&(l.headers[Ko]=$o());;)try{I.isInstance(l)&&(l.headers[Yo]=`attempt=${c+1}; max=${n}`);let{response:p,output:u}=await t(o);return s.recordSuccess(i),u.$metadata.attempts=c+1,u.$metadata.totalRetryDelay=d,{response:p,output:u}}catch(p){let u=gh(p);a=In(p);try{i=await s.refreshRetryTokenForRetry(i,u)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=c+1,a.$metadata.totalRetryDelay=d,a}c=i.getRetryCount();let m=i.getRetryDelay();d+=m,await new Promise(f=>setTimeout(f,m))}}else return s=s,s!=null&&s.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(t,o)},Eh=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",gh=e=>{let t={errorType:wh(e)},r=Sh(e.$response);return r&&(t.retryAfterHint=r),t},wh=e=>fr(e)?"THROTTLING":Wo(e)?"TRANSIENT":lc(e)?"SERVER_ERROR":"CLIENT_ERROR",xh={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},ht=e=>({applyToStack:t=>{t.add(yh(e),xh)}}),Sh=e=>{if(!be.isInstance(e))return;let t=Object.keys(e.headers).find(n=>n.toLowerCase()==="retry-after");if(!t)return;let r=e.headers[t],o=Number(r);return Number.isNaN(o)?new Date(r):new Date(o*1e3)};var re=class extends Error{constructor(t,r=!0){super(t),this.tryNextLink=r,this.name="ProviderError",Object.setPrototypeOf(this,re.prototype)}static from(t,r=!0){return Object.assign(new this(t.message,r),t)}};var w=class extends re{constructor(t,r=!0){super(t,r),this.tryNextLink=r,this.name="CredentialsProviderError",Object.setPrototypeOf(this,w.prototype)}};var oe=class extends re{constructor(t,r=!0){super(t,r),this.tryNextLink=r,this.name="TokenProviderError",Object.setPrototypeOf(this,oe.prototype)}};function Qo(...e){return()=>{let t=Promise.reject(new re("No providers in chain"));for(let r of e)t=t.catch(o=>{if(o!=null&&o.tryNextLink)return r();throw o});return t}}var xc=e=>()=>Promise.resolve(e);var yt=(e,t,r)=>{let o,s,n,i=!1,a=async()=>{s||(s=e());try{o=await s,n=!0,i=!1}finally{s=void 0}return o};return t===void 0?async c=>((!n||c!=null&&c.forceRefresh)&&(o=await a()),o):async c=>((!n||c!=null&&c.forceRefresh)&&(o=await a()),i?o:r&&!r(o)?(i=!0,o):(t(o)&&await a(),o))};var Sc={},_h={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Sc[e]=t,_h[t]=e}function Me(e){let t="";for(let r=0;r<e.byteLength;r++)t+=Sc[e[r]];return t}var Zo=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]";import{Buffer as Cn}from"buffer";var Lt=(e,t=0,r=e.byteLength-t)=>{if(!Zo(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return Cn.from(e,t,r)},Er=(e,t)=>{if(typeof e!="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?Cn.from(e,t):Cn.from(e)};var Ce=e=>{let t=Er(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)};var Pe=e=>typeof e=="string"?Ce(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e);var Et=e=>Lt(e.buffer,e.byteOffset,e.byteLength).toString("utf8");var _c="X-Amz-Algorithm",bc="X-Amz-Credential",Pn="X-Amz-Date",Rc="X-Amz-SignedHeaders",Tc="X-Amz-Expires",An="X-Amz-Signature",vn="X-Amz-Security-Token";var Nn="authorization",On=Pn.toLowerCase(),bh="date",Ic=[Nn,On,bh],Cc=An.toLowerCase(),no="x-amz-content-sha256",Pc=vn.toLowerCase();var Ac={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},vc=/^proxy-/,Nc=/^sec-/;var es="AWS4-HMAC-SHA256";var Oc="AWS4-HMAC-SHA256-PAYLOAD",kc="UNSIGNED-PAYLOAD",Dc=50,kn="aws4_request",Fc=60*60*24*7;var ts={},Dn=[],rs=(e,t,r)=>`${e}/${t}/${r}/${kn}`,Lc=async(e,t,r,o,s)=>{let n=await $c(e,t.secretAccessKey,t.accessKeyId),i=`${r}:${o}:${s}:${Me(n)}:${t.sessionToken}`;if(i in ts)return ts[i];for(Dn.push(i);Dn.length>Dc;)delete ts[Dn.shift()];let a=`AWS4${t.secretAccessKey}`;for(let c of[r,o,s,kn])a=await $c(e,a,c);return ts[i]=a};var $c=(e,t,r)=>{let o=new e(t);return o.update(Pe(r)),o.digest()};var os=({headers:e},t,r)=>{let o={};for(let s of Object.keys(e).sort()){if(e[s]==null)continue;let n=s.toLowerCase();(n in Ac||t!=null&&t.has(n)||vc.test(n)||Nc.test(n))&&(!r||r&&!r.has(n))||(o[n]=e[s].trim().replace(/\s+/g," "))}return o};var Ae=e=>encodeURIComponent(e).replace(/[!'()*]/g,Rh),Rh=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var Fn=({query:e={}})=>{let t=[],r={};for(let o of Object.keys(e).sort()){if(o.toLowerCase()===Cc)continue;t.push(o);let s=e[o];typeof s=="string"?r[o]=`${Ae(o)}=${Ae(s)}`:Array.isArray(s)&&(r[o]=s.slice(0).sort().reduce((n,i)=>n.concat([`${Ae(o)}=${Ae(i)}`]),[]).join("&"))}return t.map(o=>r[o]).filter(o=>o).join("&")};var io=async({headers:e,body:t},r)=>{for(let o of Object.keys(e))if(o.toLowerCase()===no)return e[o];if(t==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof t=="string"||ArrayBuffer.isView(t)||Zo(t)){let o=new r;return o.update(Pe(t)),Me(await o.digest())}return kc};var Mc=(e,t)=>{e=e.toLowerCase();for(let r of Object.keys(t))if(e===r.toLowerCase())return!0;return!1};var ss=({headers:e,query:t,...r})=>({...r,headers:{...e},query:t?Th(t):void 0}),Th=e=>Object.keys(e).reduce((t,r)=>{let o=e[r];return{...t,[r]:Array.isArray(o)?[...o]:o}},{});var $n=(e,t={})=>{var s;let{headers:r,query:o={}}=typeof e.clone=="function"?e.clone():ss(e);for(let n of Object.keys(r)){let i=n.toLowerCase();i.slice(0,6)==="x-amz-"&&!((s=t.unhoistableHeaders)!=null&&s.has(i))&&(o[n]=r[n],delete r[n])}return{...e,headers:r,query:o}};var ns=e=>{e=typeof e.clone=="function"?e.clone():ss(e);for(let t of Object.keys(e.headers))Ic.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e};var Uc=e=>Ih(e).toISOString().replace(/\.\d{3}Z$/,"Z"),Ih=e=>typeof e=="number"?new Date(e*1e3):typeof e=="string"?Number(e)?new Date(Number(e)*1e3):new Date(e):e;var ao=class{constructor({applyChecksum:t,credentials:r,region:o,service:s,sha256:n,uriEscapePath:i=!0}){this.service=s,this.sha256=n,this.uriEscapePath=i,this.applyChecksum=typeof t=="boolean"?t:!0,this.regionProvider=B(o),this.credentialProvider=B(r)}async presign(t,r={}){let{signingDate:o=new Date,expiresIn:s=3600,unsignableHeaders:n,unhoistableHeaders:i,signableHeaders:a,signingRegion:c,signingService:d}=r,l=await this.credentialProvider();this.validateResolvedCredentials(l);let p=c??await this.regionProvider(),{longDate:u,shortDate:m}=is(o);if(s>Fc)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let f=rs(m,p,d??this.service),h=$n(ns(t),{unhoistableHeaders:i});l.sessionToken&&(h.query[vn]=l.sessionToken),h.query[_c]=es,h.query[bc]=`${l.accessKeyId}/${f}`,h.query[Pn]=u,h.query[Tc]=s.toString(10);let E=os(h,n,a);return h.query[Rc]=zc(E),h.query[An]=await this.getSignature(u,f,this.getSigningKey(l,p,m,d),this.createCanonicalRequest(h,E,await io(t,this.sha256))),h}async sign(t,r){return typeof t=="string"?this.signString(t,r):t.headers&&t.payload?this.signEvent(t,r):this.signRequest(t,r)}async signEvent({headers:t,payload:r},{signingDate:o=new Date,priorSignature:s,signingRegion:n,signingService:i}){let a=n??await this.regionProvider(),{shortDate:c,longDate:d}=is(o),l=rs(c,a,i??this.service),p=await io({headers:{},body:r},this.sha256),u=new this.sha256;u.update(t);let m=Me(await u.digest()),f=[Oc,d,l,s,m,p].join(`
`);return this.signString(f,{signingDate:o,signingRegion:a,signingService:i})}async signString(t,{signingDate:r=new Date,signingRegion:o,signingService:s}={}){let n=await this.credentialProvider();this.validateResolvedCredentials(n);let i=o??await this.regionProvider(),{shortDate:a}=is(r),c=new this.sha256(await this.getSigningKey(n,i,a,s));return c.update(Pe(t)),Me(await c.digest())}async signRequest(t,{signingDate:r=new Date,signableHeaders:o,unsignableHeaders:s,signingRegion:n,signingService:i}={}){let a=await this.credentialProvider();this.validateResolvedCredentials(a);let c=n??await this.regionProvider(),d=ns(t),{longDate:l,shortDate:p}=is(r),u=rs(p,c,i??this.service);d.headers[On]=l,a.sessionToken&&(d.headers[Pc]=a.sessionToken);let m=await io(d,this.sha256);!Mc(no,d.headers)&&this.applyChecksum&&(d.headers[no]=m);let f=os(d,s,o),h=await this.getSignature(l,u,this.getSigningKey(a,c,p,i),this.createCanonicalRequest(d,f,m));return d.headers[Nn]=`${es} Credential=${a.accessKeyId}/${u}, SignedHeaders=${zc(f)}, Signature=${h}`,d}createCanonicalRequest(t,r,o){let s=Object.keys(r).sort();return`${t.method}
${this.getCanonicalPath(t)}
${Fn(t)}
${s.map(n=>`${n}:${r[n]}`).join(`
`)}

${s.join(";")}
${o}`}async createStringToSign(t,r,o){let s=new this.sha256;s.update(Pe(o));let n=await s.digest();return`${es}
${t}
${r}
${Me(n)}`}getCanonicalPath({path:t}){if(this.uriEscapePath){let r=[];for(let n of t.split("/"))(n==null?void 0:n.length)!==0&&n!=="."&&(n===".."?r.pop():r.push(n));let o=`${t!=null&&t.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&(t!=null&&t.endsWith("/"))?"/":""}`;return encodeURIComponent(o).replace(/%2F/g,"/")}return t}async getSignature(t,r,o,s){let n=await this.createStringToSign(t,r,s),i=new this.sha256(await o);return i.update(Pe(n)),Me(await i.digest())}getSigningKey(t,r,o,s){return Lc(this.sha256,t,o,r,s||this.service)}validateResolvedCredentials(t){if(typeof t!="object"||typeof t.accessKeyId!="string"||typeof t.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}},is=e=>{let t=Uc(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}},zc=e=>Object.keys(e).sort().join(";");var Ch=3e5,as=e=>{let t=e.credentials?Ph(e.credentials):e.credentialDefaultProvider(e),{signingEscapePath:r=!0,systemClockOffset:o=e.systemClockOffset||0,sha256:s}=e,n;return e.signer?n=B(e.signer):e.regionInfoProvider?n=()=>B(e.region)().then(async i=>[await e.regionInfoProvider(i,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},i]).then(([i,a])=>{let{signingRegion:c,signingService:d}=i;e.signingRegion=e.signingRegion||c||a,e.signingName=e.signingName||d||e.serviceId;let l={...e,credentials:t,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:r},p=e.signerConstructor||ao;return new p(l)}):n=async i=>{i=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await B(e.region)(),properties:{}},i);let a=i.signingRegion,c=i.signingName;e.signingRegion=e.signingRegion||a,e.signingName=e.signingName||c||e.serviceId;let d={...e,credentials:t,region:e.signingRegion,service:e.signingName,sha256:s,uriEscapePath:r},l=e.signerConstructor||ao;return new l(d)},{...e,systemClockOffset:o,signingEscapePath:r,credentials:t,signer:n}};var Ph=e=>typeof e=="function"?yt(e,t=>t.expiration!==void 0&&t.expiration.getTime()-Date.now()<Ch,t=>t.expiration!==void 0):B(e);var cs=e=>new Date(Date.now()+e);var qc=(e,t)=>Math.abs(cs(t).getTime()-e)>=3e5;var Ln=(e,t)=>{let r=Date.parse(e);return qc(r,t)?r-Date.now():t};var Ah=e=>(t,r)=>async function(o){var d,l,p,u;if(!I.isInstance(o.request))return t(o);let s=(p=(l=(d=r.endpointV2)==null?void 0:d.properties)==null?void 0:l.authSchemes)==null?void 0:p[0],n=(s==null?void 0:s.name)==="sigv4a"?(u=s==null?void 0:s.signingRegionSet)==null?void 0:u.join(","):void 0,i=await e.signer(s),a=await t({...o,request:await i.sign(o.request,{signingDate:cs(e.systemClockOffset),signingRegion:n||r.signing_region,signingService:r.signing_service})}).catch(m=>{let f=m.ServerTime??Bc(m.$response);throw f&&(e.systemClockOffset=Ln(f,e.systemClockOffset)),m}),c=Bc(a.response);return c&&(e.systemClockOffset=Ln(c,e.systemClockOffset)),a},Bc=e=>{var t,r;return be.isInstance(e)?((t=e.headers)==null?void 0:t.date)??((r=e.headers)==null?void 0:r.Date):void 0},vh={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},ds=e=>({applyToStack:t=>{t.addRelativeTo(Ah(e),vh)}});function gt(e){return{...e,customUserAgent:typeof e.customUserAgent=="string"?[[e.customUserAgent]]:e.customUserAgent}}var Mn={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}}],version:"1.1"};var jc=Mn,Gc="",Oh=e=>{let{partitions:t}=jc;for(let o of t){let{regions:s,outputs:n}=o;for(let[i,a]of Object.entries(s))if(i===e)return{...n,...a}}for(let o of t){let{regionRegex:s,outputs:n}=o;if(new RegExp(s).test(e))return{...n}}let r=t.find(o=>o.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},Vc=(e,t="")=>{jc=e,Gc=t},kh=()=>{Vc(Mn,"")},Un=()=>Gc;var Ue="endpoints";function me(e){return typeof e!="object"||e==null?e:"ref"in e?`$${me(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(me).join(", ")})`:JSON.stringify(e,null,2)}var C=class extends Error{constructor(t){super(t),this.name="EndpointError"}};var jn={};Us(jn,{aws:()=>zn,booleanEquals:()=>Lh,getAttr:()=>qn,isSet:()=>Mh,isValidHostLabel:()=>ps,not:()=>Uh,parseURL:()=>zh,stringEquals:()=>qh,substring:()=>Bh,uriEncode:()=>jh});var zn={};Us(zn,{getUserAgentPrefix:()=>Un,isVirtualHostableS3Bucket:()=>Hc,parseArn:()=>$h,partition:()=>Oh,setPartitionInfo:()=>Vc,useDefaultPartitionInfo:()=>kh});var Dh=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),ls=e=>Dh.test(e)||e.startsWith("[")&&e.endsWith("]");var Fh=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),ps=(e,t=!1)=>{if(!t)return Fh.test(e);let r=e.split(".");for(let o of r)if(!ps(o))return!1;return!0};var Hc=(e,t=!1)=>{if(t){for(let r of e.split("."))if(!Hc(r))return!1;return!0}return!(!ps(e)||e.length<3||e.length>63||e!==e.toLowerCase()||ls(e))};var $h=e=>{let t=e.split(":");if(t.length<6)return null;let[r,o,s,n,i,...a]=t;return r!=="arn"||o===""||s===""||a[0]===""?null:{partition:o,service:s,region:n,accountId:i,resourceId:a[0].includes("/")?a[0].split("/"):a}};var Lh=(e,t)=>e===t;var Wc=e=>{let t=e.split("."),r=[];for(let o of t){let s=o.indexOf("[");if(s!==-1){if(o.indexOf("]")!==o.length-1)throw new C(`Path: '${e}' does not end with ']'`);let n=o.slice(s+1,-1);if(Number.isNaN(parseInt(n)))throw new C(`Invalid array index: '${n}' in path: '${e}'`);s!==0&&r.push(o.slice(0,s)),r.push(n)}else r.push(o)}return r};var qn=(e,t)=>Wc(t).reduce((r,o)=>{if(typeof r!="object")throw new C(`Index '${o}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(r)?r[parseInt(o)]:r[o]},e);var Mh=e=>e!=null;var Uh=e=>!e;var Kc;(function(e){e.HEADER="header",e.QUERY="query"})(Kc||(Kc={}));var Yc;(function(e){e.AAAA="AAAA",e.A="A"})(Yc||(Yc={}));var gr;(function(e){e.HTTP="http",e.HTTPS="https"})(gr||(gr={}));var Jc;(function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"})(Jc||(Jc={}));var Bn={[gr.HTTP]:80,[gr.HTTPS]:443},zh=e=>{let t=(()=>{try{if(e instanceof URL)return e;if(typeof e=="object"&&"hostname"in e){let{hostname:u,port:m,protocol:f="",path:h="",query:E={}}=e,ie=new URL(`${f}//${u}${m?`:${m}`:""}${h}`);return ie.search=Object.entries(E).map(([Jr,J])=>`${Jr}=${J}`).join("&"),ie}return new URL(e)}catch{return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let r=t.href,{host:o,hostname:s,pathname:n,protocol:i,search:a}=t;if(a)return null;let c=i.slice(0,-1);if(!Object.values(gr).includes(c))return null;let d=ls(s),l=r.includes(`${o}:${Bn[c]}`)||typeof e=="string"&&e.includes(`${o}:${Bn[c]}`),p=`${o}${l?`:${Bn[c]}`:""}`;return{scheme:c,authority:p,path:n,normalizedPath:n.endsWith("/")?n:`${n}/`,isIp:d}};var qh=(e,t)=>e===t;var Bh=(e,t,r,o)=>t>=r||e.length<r?null:o?e.substring(e.length-r,e.length-t):e.substring(t,r);var jh=e=>encodeURIComponent(e).replace(/[!*'()]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`);var us=(e,t)=>{let r=[],o={...t.endpointParams,...t.referenceRecord},s=0;for(;s<e.length;){let n=e.indexOf("{",s);if(n===-1){r.push(e.slice(s));break}r.push(e.slice(s,n));let i=e.indexOf("}",n);if(i===-1){r.push(e.slice(n));break}e[n+1]==="{"&&e[i+1]==="}"&&(r.push(e.slice(n+1,i)),s=i+2);let a=e.substring(n+1,i);if(a.includes("#")){let[c,d]=a.split("#");r.push(qn(o[c],d))}else r.push(o[a]);s=i+1}return r.join("")};var Xc=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e];var wt=(e,t,r)=>{if(typeof e=="string")return us(e,r);if(e.fn)return ms(e,r);if(e.ref)return Xc(e,r);throw new C(`'${t}': ${String(e)} is not a string, function or reference.`)};var ms=({fn:e,argv:t},r)=>{let o=t.map(s=>["boolean","number"].includes(typeof s)?s:wt(s,"arg",r));return e.split(".").reduce((s,n)=>s[n],jn)(...o)};var Qc=({assign:e,...t},r)=>{var s,n;if(e&&e in r.referenceRecord)throw new C(`'${e}' is already defined in Reference Record.`);let o=ms(t,r);return(n=(s=r.logger)==null?void 0:s.debug)==null||n.call(s,Ue,`evaluateCondition: ${me(t)} = ${me(o)}`),{result:o===""?!0:!!o,...e!=null&&{toAssign:{name:e,value:o}}}};var wr=(e=[],t)=>{var o,s;let r={};for(let n of e){let{result:i,toAssign:a}=Qc(n,{...t,referenceRecord:{...t.referenceRecord,...r}});if(!i)return{result:i};a&&(r[a.name]=a.value,(s=(o=t.logger)==null?void 0:o.debug)==null||s.call(o,Ue,`assign: ${a.name} := ${me(a.value)}`))}return{result:!0,referenceRecord:r}};var Zc=(e,t)=>Object.entries(e).reduce((r,[o,s])=>({...r,[o]:s.map(n=>{let i=wt(n,"Header value entry",t);if(typeof i!="string")throw new C(`Header '${o}' value '${i}' is not a string`);return i})}),{});var Gn=(e,t)=>{if(Array.isArray(e))return e.map(r=>Gn(r,t));switch(typeof e){case"string":return us(e,t);case"object":if(e===null)throw new C(`Unexpected endpoint property: ${e}`);return fs(e,t);case"boolean":return e;default:throw new C(`Unexpected endpoint property type: ${typeof e}`)}};var fs=(e,t)=>Object.entries(e).reduce((r,[o,s])=>({...r,[o]:Gn(s,t)}),{});var ed=(e,t)=>{let r=wt(e,"Endpoint URL",t);if(typeof r=="string")try{return new URL(r)}catch(o){throw console.error(`Failed to construct URL with ${r}`,o),o}throw new C(`Endpoint URL must be a string, got ${typeof r}`)};var td=(e,t)=>{var l,p;let{conditions:r,endpoint:o}=e,{result:s,referenceRecord:n}=wr(r,t);if(!s)return;let i={...t,referenceRecord:{...t.referenceRecord,...n}},{url:a,properties:c,headers:d}=o;return(p=(l=t.logger)==null?void 0:l.debug)==null||p.call(l,Ue,`Resolving endpoint from template: ${me(o)}`),{...d!=null&&{headers:Zc(d,i)},...c!=null&&{properties:fs(c,i)},url:ed(a,i)}};var rd=(e,t)=>{let{conditions:r,error:o}=e,{result:s,referenceRecord:n}=wr(r,t);if(s)throw new C(wt(o,"Error",{...t,referenceRecord:{...t.referenceRecord,...n}}))};var od=(e,t)=>{let{conditions:r,rules:o}=e,{result:s,referenceRecord:n}=wr(r,t);if(s)return hs(o,{...t,referenceRecord:{...t.referenceRecord,...n}})};var hs=(e,t)=>{for(let r of e)if(r.type==="endpoint"){let o=td(r,t);if(o)return o}else if(r.type==="error")rd(r,t);else if(r.type==="tree"){let o=od(r,t);if(o)return o}else throw new C(`Unknown endpoint rule: ${r}`);throw new C("Rules evaluation failed")};var xt=(e,t)=>{var d,l,p,u,m;let{endpointParams:r,logger:o}=t,{parameters:s,rules:n}=e;(l=(d=t.logger)==null?void 0:d.debug)==null||l.call(d,Ue,`Initial EndpointParams: ${me(r)}`);let i=Object.entries(s).filter(([,f])=>f.default!=null).map(([f,h])=>[f,h.default]);if(i.length>0)for(let[f,h]of i)r[f]=r[f]??h;let a=Object.entries(s).filter(([,f])=>f.required).map(([f])=>f);for(let f of a)if(r[f]==null)throw new C(`Missing required parameter: '${f}'`);let c=hs(n,{endpointParams:r,logger:o,referenceRecord:{}});if((p=t.endpointParams)!=null&&p.Endpoint)try{let f=new URL(t.endpointParams.Endpoint),{protocol:h,port:E}=f;c.url.protocol=h,c.url.port=E}catch{}return(m=(u=t.logger)==null?void 0:u.debug)==null||m.call(u,Ue,`Resolved endpoint: ${me(c)}`),c};var Vn="user-agent",ys="x-amz-user-agent",Hn=" ",sd=/[^\!\#\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g;var Gh=e=>(t,r)=>async o=>{var u,m;let{request:s}=o;if(!I.isInstance(s))return t(o);let{headers:n}=s,i=((u=r==null?void 0:r.userAgent)==null?void 0:u.map(Wn))||[],a=(await e.defaultUserAgentProvider()).map(Wn),c=((m=e==null?void 0:e.customUserAgent)==null?void 0:m.map(Wn))||[],d=Un(),l=(d?[d]:[]).concat([...a,...i,...c]).join(Hn),p=[...a.filter(f=>f.startsWith("aws-sdk-")),...c].join(Hn);return e.runtime!=="browser"?(p&&(n[ys]=n[ys]?`${n[Vn]} ${p}`:p),n[Vn]=l):n[ys]=l,t({...o,request:s})},Wn=([e,t])=>{let r=e.indexOf("/"),o=e.substring(0,r),s=e.substring(r+1);return o==="api"&&(s=s.toLowerCase()),[o,s,t].filter(n=>n&&n.length>0).map(n=>n==null?void 0:n.replace(sd,"_")).join("/")},Vh={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},St=e=>({applyToStack:t=>{t.add(Gh(e),Vh)}});var nd=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"ecr"});var id={name:"@aws-sdk/client-ecr",description:"AWS SDK for JavaScript Ecr Client for Node.js, Browser and React Native",version:"3.321.1",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"tsc -p tsconfig.cjs.json","build:docs":"typedoc","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo ecr"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/client-sts":"3.321.1","@aws-sdk/config-resolver":"3.310.0","@aws-sdk/credential-provider-node":"3.321.1","@aws-sdk/fetch-http-handler":"3.310.0","@aws-sdk/hash-node":"3.310.0","@aws-sdk/invalid-dependency":"3.310.0","@aws-sdk/middleware-content-length":"3.310.0","@aws-sdk/middleware-endpoint":"3.310.0","@aws-sdk/middleware-host-header":"3.310.0","@aws-sdk/middleware-logger":"3.310.0","@aws-sdk/middleware-recursion-detection":"3.310.0","@aws-sdk/middleware-retry":"3.310.0","@aws-sdk/middleware-serde":"3.310.0","@aws-sdk/middleware-signing":"3.310.0","@aws-sdk/middleware-stack":"3.310.0","@aws-sdk/middleware-user-agent":"3.319.0","@aws-sdk/node-config-provider":"3.310.0","@aws-sdk/node-http-handler":"3.321.1","@aws-sdk/protocol-http":"3.310.0","@aws-sdk/smithy-client":"3.316.0","@aws-sdk/types":"3.310.0","@aws-sdk/url-parser":"3.310.0","@aws-sdk/util-base64":"3.310.0","@aws-sdk/util-body-length-browser":"3.310.0","@aws-sdk/util-body-length-node":"3.310.0","@aws-sdk/util-defaults-mode-browser":"3.316.0","@aws-sdk/util-defaults-mode-node":"3.316.0","@aws-sdk/util-endpoints":"3.319.0","@aws-sdk/util-retry":"3.310.0","@aws-sdk/util-user-agent-browser":"3.310.0","@aws-sdk/util-user-agent-node":"3.310.0","@aws-sdk/util-utf8":"3.310.0","@aws-sdk/util-waiter":"3.310.0",tslib:"^2.5.0"},devDependencies:{"@aws-sdk/service-client-documentation-generator":"3.310.0","@tsconfig/node14":"1.0.3","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typedoc:"0.23.23",typescript:"~4.9.5"},engines:{node:">=14.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-ecr",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-ecr"}};var Md=vi(Ld());var ne=class extends ue{constructor(t){super(t),Object.setPrototypeOf(this,ne.prototype)}};var xr=class extends ne{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),this.name="ExpiredTokenException",this.$fault="client",Object.setPrototypeOf(this,xr.prototype)}},Sr=class extends ne{constructor(t){super({name:"MalformedPolicyDocumentException",$fault:"client",...t}),this.name="MalformedPolicyDocumentException",this.$fault="client",Object.setPrototypeOf(this,Sr.prototype)}},_r=class extends ne{constructor(t){super({name:"PackedPolicyTooLargeException",$fault:"client",...t}),this.name="PackedPolicyTooLargeException",this.$fault="client",Object.setPrototypeOf(this,_r.prototype)}},br=class extends ne{constructor(t){super({name:"RegionDisabledException",$fault:"client",...t}),this.name="RegionDisabledException",this.$fault="client",Object.setPrototypeOf(this,br.prototype)}},Rr=class extends ne{constructor(t){super({name:"IDPRejectedClaimException",$fault:"client",...t}),this.name="IDPRejectedClaimException",this.$fault="client",Object.setPrototypeOf(this,Rr.prototype)}},Tr=class extends ne{constructor(t){super({name:"InvalidIdentityTokenException",$fault:"client",...t}),this.name="InvalidIdentityTokenException",this.$fault="client",Object.setPrototypeOf(this,Tr.prototype)}},Ir=class extends ne{constructor(t){super({name:"IDPCommunicationErrorException",$fault:"client",...t}),this.name="IDPCommunicationErrorException",this.$fault="client",Object.setPrototypeOf(this,Ir.prototype)}};var Ud=async(e,t)=>{let r=Qd,o;return o=el({...Zy(e,t),Action:"AssumeRole",Version:"2011-06-15"}),Xd(t,r,"/",void 0,o)};var zd=async(e,t)=>{let r=Qd,o;return o=el({...eE(e,t),Action:"AssumeRoleWithWebIdentity",Version:"2011-06-15"}),Xd(t,r,"/",void 0,o)};var qd=async(e,t)=>{if(e.statusCode>=300)return Ky(e,t);let r=await si(e.body,t),o={};return o=nE(r.AssumeRoleResult,t),{$metadata:qe(e),...o}},Ky=async(e,t)=>{let r={...e,body:await Zd(e.body,t)},o=tl(e,r.body);switch(o){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await jd(r,t);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await Gd(r,t);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await Vd(r,t);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await Hd(r,t);default:let s=r.body;return Jd({output:e,parsedBody:s.Error,errorCode:o})}};var Bd=async(e,t)=>{if(e.statusCode>=300)return Yy(e,t);let r=await si(e.body,t),o={};return o=iE(r.AssumeRoleWithWebIdentityResult,t),{$metadata:qe(e),...o}},Yy=async(e,t)=>{let r={...e,body:await Zd(e.body,t)},o=tl(e,r.body);switch(o){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await jd(r,t);case"IDPCommunicationError":case"com.amazonaws.sts#IDPCommunicationErrorException":throw await Jy(r,t);case"IDPRejectedClaim":case"com.amazonaws.sts#IDPRejectedClaimException":throw await Xy(r,t);case"InvalidIdentityToken":case"com.amazonaws.sts#InvalidIdentityTokenException":throw await Qy(r,t);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await Gd(r,t);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await Vd(r,t);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await Hd(r,t);default:let s=r.body;return Jd({output:e,parsedBody:s.Error,errorCode:o})}};var jd=async(e,t)=>{let r=e.body,o=aE(r.Error,t),s=new xr({$metadata:qe(e),...o});return S(s,r)},Jy=async(e,t)=>{let r=e.body,o=cE(r.Error,t),s=new Ir({$metadata:qe(e),...o});return S(s,r)},Xy=async(e,t)=>{let r=e.body,o=dE(r.Error,t),s=new Rr({$metadata:qe(e),...o});return S(s,r)};var Qy=async(e,t)=>{let r=e.body,o=lE(r.Error,t),s=new Tr({$metadata:qe(e),...o});return S(s,r)},Gd=async(e,t)=>{let r=e.body,o=pE(r.Error,t),s=new Sr({$metadata:qe(e),...o});return S(s,r)},Vd=async(e,t)=>{let r=e.body,o=uE(r.Error,t),s=new _r({$metadata:qe(e),...o});return S(s,r)},Hd=async(e,t)=>{let r=e.body,o=mE(r.Error,t),s=new br({$metadata:qe(e),...o});return S(s,r)},Zy=(e,t)=>{var o,s,n;let r={};if(e.RoleArn!=null&&(r.RoleArn=e.RoleArn),e.RoleSessionName!=null&&(r.RoleSessionName=e.RoleSessionName),e.PolicyArns!=null){let i=Wd(e.PolicyArns,t);((o=e.PolicyArns)==null?void 0:o.length)===0&&(r.PolicyArns=[]),Object.entries(i).forEach(([a,c])=>{let d=`PolicyArns.${a}`;r[d]=c})}if(e.Policy!=null&&(r.Policy=e.Policy),e.DurationSeconds!=null&&(r.DurationSeconds=e.DurationSeconds),e.Tags!=null){let i=sE(e.Tags,t);((s=e.Tags)==null?void 0:s.length)===0&&(r.Tags=[]),Object.entries(i).forEach(([a,c])=>{let d=`Tags.${a}`;r[d]=c})}if(e.TransitiveTagKeys!=null){let i=oE(e.TransitiveTagKeys,t);((n=e.TransitiveTagKeys)==null?void 0:n.length)===0&&(r.TransitiveTagKeys=[]),Object.entries(i).forEach(([a,c])=>{let d=`TransitiveTagKeys.${a}`;r[d]=c})}return e.ExternalId!=null&&(r.ExternalId=e.ExternalId),e.SerialNumber!=null&&(r.SerialNumber=e.SerialNumber),e.TokenCode!=null&&(r.TokenCode=e.TokenCode),e.SourceIdentity!=null&&(r.SourceIdentity=e.SourceIdentity),r};var eE=(e,t)=>{var o;let r={};if(e.RoleArn!=null&&(r.RoleArn=e.RoleArn),e.RoleSessionName!=null&&(r.RoleSessionName=e.RoleSessionName),e.WebIdentityToken!=null&&(r.WebIdentityToken=e.WebIdentityToken),e.ProviderId!=null&&(r.ProviderId=e.ProviderId),e.PolicyArns!=null){let s=Wd(e.PolicyArns,t);((o=e.PolicyArns)==null?void 0:o.length)===0&&(r.PolicyArns=[]),Object.entries(s).forEach(([n,i])=>{let a=`PolicyArns.${n}`;r[a]=i})}return e.Policy!=null&&(r.Policy=e.Policy),e.DurationSeconds!=null&&(r.DurationSeconds=e.DurationSeconds),r};var Wd=(e,t)=>{let r={},o=1;for(let s of e){if(s===null)continue;let n=tE(s,t);Object.entries(n).forEach(([i,a])=>{r[`member.${o}.${i}`]=a}),o++}return r},tE=(e,t)=>{let r={};return e.arn!=null&&(r.arn=e.arn),r},rE=(e,t)=>{let r={};return e.Key!=null&&(r.Key=e.Key),e.Value!=null&&(r.Value=e.Value),r},oE=(e,t)=>{let r={},o=1;for(let s of e)s!==null&&(r[`member.${o}`]=s,o++);return r},sE=(e,t)=>{let r={},o=1;for(let s of e){if(s===null)continue;let n=rE(s,t);Object.entries(n).forEach(([i,a])=>{r[`member.${o}.${i}`]=a}),o++}return r},Kd=(e,t)=>{let r={};return e.AssumedRoleId!==void 0&&(r.AssumedRoleId=g(e.AssumedRoleId)),e.Arn!==void 0&&(r.Arn=g(e.Arn)),r},nE=(e,t)=>{let r={};return e.Credentials!==void 0&&(r.Credentials=Yd(e.Credentials,t)),e.AssumedRoleUser!==void 0&&(r.AssumedRoleUser=Kd(e.AssumedRoleUser,t)),e.PackedPolicySize!==void 0&&(r.PackedPolicySize=mn(e.PackedPolicySize)),e.SourceIdentity!==void 0&&(r.SourceIdentity=g(e.SourceIdentity)),r};var iE=(e,t)=>{let r={};return e.Credentials!==void 0&&(r.Credentials=Yd(e.Credentials,t)),e.SubjectFromWebIdentityToken!==void 0&&(r.SubjectFromWebIdentityToken=g(e.SubjectFromWebIdentityToken)),e.AssumedRoleUser!==void 0&&(r.AssumedRoleUser=Kd(e.AssumedRoleUser,t)),e.PackedPolicySize!==void 0&&(r.PackedPolicySize=mn(e.PackedPolicySize)),e.Provider!==void 0&&(r.Provider=g(e.Provider)),e.Audience!==void 0&&(r.Audience=g(e.Audience)),e.SourceIdentity!==void 0&&(r.SourceIdentity=g(e.SourceIdentity)),r},Yd=(e,t)=>{let r={};return e.AccessKeyId!==void 0&&(r.AccessKeyId=g(e.AccessKeyId)),e.SecretAccessKey!==void 0&&(r.SecretAccessKey=g(e.SecretAccessKey)),e.SessionToken!==void 0&&(r.SessionToken=g(e.SessionToken)),e.Expiration!==void 0&&(r.Expiration=_e(Ma(e.Expiration))),r};var aE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r};var cE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r},dE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r};var lE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r},pE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r},uE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r},mE=(e,t)=>{let r={};return e.message!==void 0&&(r.message=g(e.message)),r},qe=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),fE=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),hE=(e,t)=>fE(e,t).then(r=>t.utf8Encoder(r)),Jd=Ze(ne),Xd=async(e,t,r,o,s)=>{let{hostname:n,protocol:i="https",port:a,path:c}=await e.endpoint(),d={protocol:i,hostname:n,port:a,method:"POST",path:c.endsWith("/")?c.slice(0,-1)+r:c+r,headers:t};return o!==void 0&&(d.hostname=o),s!==void 0&&(d.body=s),new I(d)},Qd={"content-type":"application/x-www-form-urlencoded"},si=(e,t)=>hE(e,t).then(r=>{if(r.length){let o=new Md.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(c,d)=>d.trim()===""&&d.includes(`
`)?"":void 0});o.addEntity("#xD","\r"),o.addEntity("#10",`
`);let s=o.parse(r),n="#text",i=Object.keys(s)[0],a=s[i];return a[n]&&(a[i]=a[n],delete a[n]),fn(a)}return{}}),Zd=async(e,t)=>{let r=await si(e,t);return r.Error&&(r.Error.message=r.Error.message??r.Error.Message),r},el=e=>Object.entries(e).map(([t,r])=>Go(t)+"="+Go(r)).join("&"),tl=(e,t)=>{var r;if(((r=t.Error)==null?void 0:r.Code)!==void 0)return t.Error.Code;if(e.statusCode==404)return"NotFound"};var Cr=class extends H{static getEndpointParameterInstructions(){return{UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,Cr.getEndpointParameterInstructions())),this.middlewareStack.use(ds(r));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"STSClient",commandName:"AssumeRoleCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return Ud(t,r)}deserialize(t,r){return qd(t,r)}};var Pr=class extends H{static getEndpointParameterInstructions(){return{UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,Pr.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"STSClient",commandName:"AssumeRoleWithWebIdentityCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return zd(t,r)}deserialize(t,r){return Bd(t,r)}};var rl=(e,{stsClientCtor:t})=>as({...e,stsClientCtor:t});var ol=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,defaultSigningName:"sts"});var sl={name:"@aws-sdk/client-sts",description:"AWS SDK for JavaScript Sts Client for Node.js, Browser and React Native",version:"3.321.1",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"tsc -p tsconfig.cjs.json","build:docs":"typedoc","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sts",test:"yarn test:unit","test:unit":"jest"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/config-resolver":"3.310.0","@aws-sdk/credential-provider-node":"3.321.1","@aws-sdk/fetch-http-handler":"3.310.0","@aws-sdk/hash-node":"3.310.0","@aws-sdk/invalid-dependency":"3.310.0","@aws-sdk/middleware-content-length":"3.310.0","@aws-sdk/middleware-endpoint":"3.310.0","@aws-sdk/middleware-host-header":"3.310.0","@aws-sdk/middleware-logger":"3.310.0","@aws-sdk/middleware-recursion-detection":"3.310.0","@aws-sdk/middleware-retry":"3.310.0","@aws-sdk/middleware-sdk-sts":"3.310.0","@aws-sdk/middleware-serde":"3.310.0","@aws-sdk/middleware-signing":"3.310.0","@aws-sdk/middleware-stack":"3.310.0","@aws-sdk/middleware-user-agent":"3.319.0","@aws-sdk/node-config-provider":"3.310.0","@aws-sdk/node-http-handler":"3.321.1","@aws-sdk/protocol-http":"3.310.0","@aws-sdk/smithy-client":"3.316.0","@aws-sdk/types":"3.310.0","@aws-sdk/url-parser":"3.310.0","@aws-sdk/util-base64":"3.310.0","@aws-sdk/util-body-length-browser":"3.310.0","@aws-sdk/util-body-length-node":"3.310.0","@aws-sdk/util-defaults-mode-browser":"3.316.0","@aws-sdk/util-defaults-mode-node":"3.316.0","@aws-sdk/util-endpoints":"3.319.0","@aws-sdk/util-retry":"3.310.0","@aws-sdk/util-user-agent-browser":"3.310.0","@aws-sdk/util-user-agent-node":"3.310.0","@aws-sdk/util-utf8":"3.310.0","fast-xml-parser":"4.1.2",tslib:"^2.5.0"},devDependencies:{"@aws-sdk/service-client-documentation-generator":"3.310.0","@tsconfig/node14":"1.0.3","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typedoc:"0.23.23",typescript:"~4.9.5"},engines:{node:">=14.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sts",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sts"}};var nl="us-east-1",il=e=>typeof e!="function"?e===void 0?nl:e:async()=>{try{return await e()}catch{return nl}},ni=(e,t)=>{let r,o;return async(s,n)=>{if(o=s,!r){let{logger:a,region:c,requestHandler:d}=e;r=new t({logger:a,credentialDefaultProvider:()=>async()=>o,region:il(c||e.region),...d?{requestHandler:d}:{}})}let{Credentials:i}=await r.send(new Cr(n));if(!i||!i.AccessKeyId||!i.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRole call with role ${n.RoleArn}`);return{accessKeyId:i.AccessKeyId,secretAccessKey:i.SecretAccessKey,sessionToken:i.SessionToken,expiration:i.Expiration}}},ii=(e,t)=>{let r;return async o=>{if(!r){let{logger:n,region:i,requestHandler:a}=e;r=new t({logger:n,region:il(i||e.region),...a?{requestHandler:a}:{}})}let{Credentials:s}=await r.send(new Pr(o));if(!s||!s.AccessKeyId||!s.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${o.RoleArn}`);return{accessKeyId:s.AccessKeyId,secretAccessKey:s.SecretAccessKey,sessionToken:s.SessionToken,expiration:s.Expiration}}},al=e=>t=>e({roleAssumer:ni(t,t.stsClientCtor),roleAssumerWithWebIdentity:ii(t,t.stsClientCtor),...t});var EE="AWS_ACCESS_KEY_ID",gE="AWS_SECRET_ACCESS_KEY",wE="AWS_SESSION_TOKEN",xE="AWS_CREDENTIAL_EXPIRATION",Es=()=>async()=>{let e=process.env[EE],t=process.env[gE],r=process.env[wE],o=process.env[xE];if(e&&t)return{accessKeyId:e,secretAccessKey:t,...r&&{sessionToken:r},...o&&{expiration:new Date(o)}};throw new w("Unable to find environment variable credentials.")};import{homedir as SE}from"os";import{sep as _E}from"path";var Ar=()=>{let{HOME:e,USERPROFILE:t,HOMEPATH:r,HOMEDRIVE:o=`C:${_E}`}=process.env;return e||t||(r?`${o}${r}`:SE())};var ai="AWS_PROFILE",bE="default",fe=e=>e.profile||process.env[ai]||bE;import{createHash as RE}from"crypto";import{join as TE}from"path";var gs=e=>{let r=RE("sha1").update(e).digest("hex");return TE(Ar(),".aws","sso","cache",`${r}.json`)};import{promises as IE}from"fs";var{readFile:CE}=IE,ws=async e=>{let t=gs(e),r=await CE(t,"utf8");return JSON.parse(r)};import{join as PE}from"path";var AE="AWS_CONFIG_FILE",xs=()=>process.env[AE]||PE(Ar(),".aws","config");import{join as vE}from"path";var NE="AWS_SHARED_CREDENTIALS_FILE",cl=()=>process.env[NE]||vE(Ar(),".aws","credentials");var dl=/^profile\s(["'])?([^\1]+)\1$/,ll=e=>Object.entries(e).filter(([t])=>dl.test(t)).reduce((t,[r,o])=>({...t,[dl.exec(r)[2]]:o}),{...e.default&&{default:e.default}});var OE=["__proto__","profile __proto__"],po=e=>{let t={},r;for(let o of e.split(/\r?\n/))if(o=o.split(/(^|\s)[;#]/)[0].trim(),o[0]==="["&&o[o.length-1]==="]"){if(r=o.substring(1,o.length-1),OE.includes(r))throw new Error(`Found invalid profile name "${r}"`)}else if(r){let n=o.indexOf("="),i=0,a=o.length-1;if(n!==-1&&n!==i&&n!==a){let[d,l]=[o.substring(0,n).trim(),o.substring(n+1).trim()];t[r]=t[r]||{},t[r][d]=l}}return t};import{promises as kE}from"fs";var{readFile:DE}=kE,ci={},uo=(e,t)=>((!ci[e]||t!=null&&t.ignoreCache)&&(ci[e]=DE(e,"utf8")),ci[e]);var pl=()=>({}),Ss=async(e={})=>{let{filepath:t=cl(),configFilepath:r=xs()}=e,o=await Promise.all([uo(r,{ignoreCache:e.ignoreCache}).then(po).then(ll).catch(pl),uo(t,{ignoreCache:e.ignoreCache}).then(po).catch(pl)]);return{configFile:o[0],credentialsFile:o[1]}};var ul=/^sso-session\s(["'])?([^\1]+)\1$/,ml=e=>Object.entries(e).filter(([t])=>ul.test(t)).reduce((t,[r,o])=>({...t,[ul.exec(r)[2]]:o}),{});var FE=()=>({}),_s=async(e={})=>uo(e.configFilepath??xs()).then(po).then(ml).catch(FE);var fl=(...e)=>{let t={};for(let r of e)for(let[o,s]of Object.entries(r))t[o]!==void 0?Object.assign(t[o],s):t[o]=s;return t};var bt=async e=>{let t=await Ss(e);return fl(t.configFile,t.credentialsFile)};import{parse as ME}from"url";import{Buffer as $E}from"buffer";import{request as LE}from"http";function Be(e){return new Promise((t,r)=>{var s;let o=LE({method:"GET",...e,hostname:(s=e.hostname)==null?void 0:s.replace(/^\[(.+)\]$/,"$1")});o.on("error",n=>{r(Object.assign(new re("Unable to connect to instance metadata service"),n)),o.destroy()}),o.on("timeout",()=>{r(new re("TimeoutError from instance metadata service")),o.destroy()}),o.on("response",n=>{let{statusCode:i=400}=n;(i<200||300<=i)&&(r(Object.assign(new re("Error response received from instance metadata service"),{statusCode:i})),o.destroy());let a=[];n.on("data",c=>{a.push(c)}),n.on("end",()=>{t($E.concat(a)),o.destroy()})}),o.end()})}var bs=e=>!!e&&typeof e=="object"&&typeof e.AccessKeyId=="string"&&typeof e.SecretAccessKey=="string"&&typeof e.Token=="string"&&typeof e.Expiration=="string",Rs=e=>({accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration)});var Ts=({maxRetries:e=0,timeout:t=1e3})=>({maxRetries:e,timeout:t});var mo=(e,t)=>{let r=e();for(let o=0;o<t;o++)r=r.catch(e);return r};var fo="AWS_CONTAINER_CREDENTIALS_FULL_URI",ho="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",hl="AWS_CONTAINER_AUTHORIZATION_TOKEN",Is=(e={})=>{let{timeout:t,maxRetries:r}=Ts(e);return()=>mo(async()=>{let o=await jE(),s=JSON.parse(await UE(t,o));if(!bs(s))throw new w("Invalid response received from instance metadata service.");return Rs(s)},r)},UE=async(e,t)=>(process.env[hl]&&(t.headers={...t.headers,Authorization:process.env[hl]}),(await Be({...t,timeout:e})).toString()),zE="169.254.170.2",qE={localhost:!0,"127.0.0.1":!0},BE={"http:":!0,"https:":!0},jE=async()=>{if(process.env[ho])return{hostname:zE,path:process.env[ho]};if(process.env[fo]){let e=ME(process.env[fo]);if(!e.hostname||!(e.hostname in qE))throw new w(`${e.hostname} is not a valid container metadata service hostname`,!1);if(!e.protocol||!(e.protocol in BE))throw new w(`${e.protocol} is not a valid container metadata service protocol`,!1);return{...e,port:e.port?parseInt(e.port,10):void 0}}throw new w(`The container metadata credential provider cannot be used unless the ${ho} or ${fo} environment variable is set`,!1)};var yl=e=>async()=>{try{let t=e(process.env);if(t===void 0)throw new Error;return t}catch(t){throw new w(t.message||`Cannot load config from environment variables with getter: ${e}`)}};var El=(e,{preferredFile:t="config",...r}={})=>async()=>{let o=fe(r),{configFile:s,credentialsFile:n}=await Ss(r),i=n[o]||{},a=s[o]||{},c=t==="config"?{...i,...a}:{...a,...i};try{let d=e(c);if(d===void 0)throw new Error;return d}catch(d){throw new w(d.message||`Cannot load config for profile ${o} in SDK configuration files with getter: ${e}`)}};var GE=e=>typeof e=="function",gl=e=>GE(e)?async()=>await e():xc(e);var _=({environmentVariableSelector:e,configFileSelector:t,default:r},o={})=>yt(Qo(yl(e),El(t,o),gl(r)));var yo;(function(e){e.IPv4="http://169.254.169.254",e.IPv6="http://[fd00:ec2::254]"})(yo||(yo={}));var VE="AWS_EC2_METADATA_SERVICE_ENDPOINT",HE="ec2_metadata_service_endpoint",wl={environmentVariableSelector:e=>e[VE],configFileSelector:e=>e[HE],default:void 0};var Rt;(function(e){e.IPv4="IPv4",e.IPv6="IPv6"})(Rt||(Rt={}));var WE="AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE",KE="ec2_metadata_service_endpoint_mode",xl={environmentVariableSelector:e=>e[WE],configFileSelector:e=>e[KE],default:Rt.IPv4};var Eo=async()=>Z(await YE()||await JE()),YE=async()=>_(wl)(),JE=async()=>{let e=await _(xl)();switch(e){case Rt.IPv4:return yo.IPv4;case Rt.IPv6:return yo.IPv6;default:throw new Error(`Unsupported endpoint mode: ${e}. Select from ${Object.values(Rt)}`)}};var XE="https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html",di=(e,t)=>{let r=300+Math.floor(Math.random()*300),o=new Date(Date.now()+r*1e3);t.warn("Attempting credential expiration extension due to a credential service availability issue. A refresh of these credentials will be attempted after ${new Date(newExpiration)}.\nFor more information, please visit: "+XE);let s=e.originalExpiration??e.expiration;return{...e,...s?{originalExpiration:s}:{},expiration:o}};var Sl=(e,t={})=>{let r=(t==null?void 0:t.logger)||console,o;return async()=>{let s;try{s=await e(),s.expiration&&s.expiration.getTime()<Date.now()&&(s=di(s,r))}catch(n){if(o)r.warn("Credential renew failed: ",n),s=di(o,r);else throw n}return o=s,s}};var _l="/latest/meta-data/iam/security-credentials/",QE="/latest/api/token",Cs=(e={})=>Sl(ZE(e),{logger:e.logger}),ZE=e=>{let t=!1,{timeout:r,maxRetries:o}=Ts(e),s=async(n,i)=>{let a=(await mo(async()=>{let c;try{c=await tg(i)}catch(d){throw d.statusCode===401&&(t=!1),d}return c},n)).trim();return mo(async()=>{let c;try{c=await rg(a,i)}catch(d){throw d.statusCode===401&&(t=!1),d}return c},n)};return async()=>{let n=await Eo();if(t)return s(o,{...n,timeout:r});{let i;try{i=(await eg({...n,timeout:r})).toString()}catch(a){if((a==null?void 0:a.statusCode)===400)throw Object.assign(a,{message:"EC2 Metadata token request returned error"});return(a.message==="TimeoutError"||[403,404,405].includes(a.statusCode))&&(t=!0),s(o,{...n,timeout:r})}return s(o,{...n,headers:{"x-aws-ec2-metadata-token":i},timeout:r})}}},eg=async e=>Be({...e,path:QE,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}),tg=async e=>(await Be({...e,path:_l})).toString(),rg=async(e,t)=>{let r=JSON.parse((await Be({...t,path:_l+e})).toString());if(!bs(r))throw new w("Invalid response received from instance metadata service.");return Rs(r)};var bl=(e,t)=>{let r={EcsContainer:Is,Ec2InstanceMetadata:Cs,Environment:Es};if(e in r)return r[e]();throw new w(`Unsupported credential source in profile ${t}. Got ${e}, expected EcsContainer or Ec2InstanceMetadata or Environment.`)};var Rl=e=>!!e&&typeof e=="object"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1&&(og(e)||sg(e)),og=e=>typeof e.source_profile=="string"&&typeof e.credential_source>"u",sg=e=>typeof e.credential_source=="string"&&typeof e.source_profile>"u",Tl=async(e,t,r,o={})=>{let s=t[e];if(!r.roleAssumer)throw new w(`Profile ${e} requires a role to be assumed, but no role assumption callback was provided.`,!1);let{source_profile:n}=s;if(n&&n in o)throw new w(`Detected a cycle attempting to resolve credentials for profile ${fe(r)}. Profiles visited: `+Object.keys(o).join(", "),!1);let i=n?Ps(n,t,r,{...o,[n]:!0}):bl(s.credential_source,e)(),a={RoleArn:s.role_arn,RoleSessionName:s.role_session_name||`aws-sdk-js-${Date.now()}`,ExternalId:s.external_id},{mfa_serial:c}=s;if(c){if(!r.mfaCodeProvider)throw new w(`Profile ${e} requires multi-factor authentication, but no MFA code callback was provided.`,!1);a.SerialNumber=c,a.TokenCode=await r.mfaCodeProvider(c)}let d=await i;return r.roleAssumer(d,a)};import{exec as ng}from"child_process";import{promisify as ig}from"util";var Il=(e,t)=>{if(t.Version!==1)throw Error(`Profile ${e} credential_process did not return Version 1.`);if(t.AccessKeyId===void 0||t.SecretAccessKey===void 0)throw Error(`Profile ${e} credential_process returned invalid credentials.`);if(t.Expiration){let r=new Date;if(new Date(t.Expiration)<r)throw Error(`Profile ${e} credential_process returned expired credentials.`)}return{accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,...t.SessionToken&&{sessionToken:t.SessionToken},...t.Expiration&&{expiration:new Date(t.Expiration)}}};var Cl=async(e,t)=>{let r=t[e];if(t[e]){let o=r.credential_process;if(o!==void 0){let s=ig(ng);try{let{stdout:n}=await s(o),i;try{i=JSON.parse(n.trim())}catch{throw Error(`Profile ${e} credential_process returned invalid JSON.`)}return Il(e,i)}catch(n){throw new w(n.message)}}else throw new w(`Profile ${e} did not contain credential_process.`)}else throw new w(`Profile ${e} could not be found in shared credentials file.`)};var As=(e={})=>async()=>{let t=await bt(e);return Cl(fe(e),t)};var Pl=e=>!!e&&typeof e=="object"&&typeof e.credential_process=="string",Al=async(e,t)=>As({...e,profile:t})();var go=e=>e&&(typeof e.sso_start_url=="string"||typeof e.sso_account_id=="string"||typeof e.sso_session=="string"||typeof e.sso_region=="string"||typeof e.sso_role_name=="string");var ge=class extends ue{constructor(t){super(t),Object.setPrototypeOf(this,ge.prototype)}};var vr=class extends ge{constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),this.name="InvalidRequestException",this.$fault="client",Object.setPrototypeOf(this,vr.prototype)}},Nr=class extends ge{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t}),this.name="ResourceNotFoundException",this.$fault="client",Object.setPrototypeOf(this,Nr.prototype)}},Or=class extends ge{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t}),this.name="TooManyRequestsException",this.$fault="client",Object.setPrototypeOf(this,Or.prototype)}},kr=class extends ge{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t}),this.name="UnauthorizedException",this.$fault="client",Object.setPrototypeOf(this,kr.prototype)}},vl=e=>({...e,...e.accessToken&&{accessToken:Bo}}),ag=e=>({...e,...e.secretAccessKey&&{secretAccessKey:Bo},...e.sessionToken&&{sessionToken:Bo}}),Nl=e=>({...e,...e.roleCredentials&&{roleCredentials:ag(e.roleCredentials)}});var Ol=async(e,t)=>{let{hostname:r,protocol:o="https",port:s,path:n}=await t.endpoint(),i=O({},yg,{"x-amz-sso_bearer_token":e.accessToken}),a=`${n!=null&&n.endsWith("/")?n.slice(0,-1):n||""}/federation/credentials`,c=O({role_name:[,_e(e.roleName,"roleName")],account_id:[,_e(e.accountId,"accountId")]}),d;return new I({protocol:o,hostname:r,port:s,method:"GET",headers:i,path:a,query:c,body:d})};var kl=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return cg(e,t);let r=O({$metadata:wo(e)}),o=_e(jo(await Dl(e.body,t)),"body"),s=v(o,{roleCredentials:D});return Object.assign(r,s),r},cg=async(e,t)=>{let r={...e,body:await Eg(e.body,t)},o=gg(e,r.body);switch(o){case"InvalidRequestException":case"com.amazonaws.sso#InvalidRequestException":throw await lg(r,t);case"ResourceNotFoundException":case"com.amazonaws.sso#ResourceNotFoundException":throw await pg(r,t);case"TooManyRequestsException":case"com.amazonaws.sso#TooManyRequestsException":throw await ug(r,t);case"UnauthorizedException":case"com.amazonaws.sso#UnauthorizedException":throw await mg(r,t);default:let s=r.body;return dg({output:e,parsedBody:s,errorCode:o})}};var dg=Ze(ge),lg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{message:g});Object.assign(r,s);let n=new vr({$metadata:wo(e),...r});return S(n,e.body)},pg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{message:g});Object.assign(r,s);let n=new Nr({$metadata:wo(e),...r});return S(n,e.body)},ug=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{message:g});Object.assign(r,s);let n=new Or({$metadata:wo(e),...r});return S(n,e.body)},mg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{message:g});Object.assign(r,s);let n=new kr({$metadata:wo(e),...r});return S(n,e.body)},wo=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),fg=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),hg=(e,t)=>fg(e,t).then(r=>t.utf8Encoder(r)),yg=e=>e!=null&&e!==""&&(!Object.getOwnPropertyNames(e).includes("length")||e.length!=0)&&(!Object.getOwnPropertyNames(e).includes("size")||e.size!=0),Dl=(e,t)=>hg(e,t).then(r=>r.length?JSON.parse(r):{}),Eg=async(e,t)=>{let r=await Dl(e,t);return r.message=r.message??r.Message,r},gg=(e,t)=>{let r=(n,i)=>Object.keys(n).find(a=>a.toLowerCase()===i.toLowerCase()),o=n=>{let i=n;return typeof i=="number"&&(i=i.toString()),i.indexOf(",")>=0&&(i=i.split(",")[0]),i.indexOf(":")>=0&&(i=i.split(":")[0]),i.indexOf("#")>=0&&(i=i.split("#")[1]),i},s=r(e.headers,"x-amzn-errortype");if(s!==void 0)return o(e.headers[s]);if(t.code!==void 0)return o(t.code);if(t.__type!==void 0)return o(t.__type)};var Dr=class extends H{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,Dr.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"SSOClient",commandName:"GetRoleCredentialsCommand",inputFilterSensitiveLog:vl,outputFilterSensitiveLog:Nl},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return Ol(t,r)}deserialize(t,r){return kl(t,r)}};var Fl=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"awsssoportal"});var $l={name:"@aws-sdk/client-sso",description:"AWS SDK for JavaScript Sso Client for Node.js, Browser and React Native",version:"3.321.1",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"tsc -p tsconfig.cjs.json","build:docs":"typedoc","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sso"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/config-resolver":"3.310.0","@aws-sdk/fetch-http-handler":"3.310.0","@aws-sdk/hash-node":"3.310.0","@aws-sdk/invalid-dependency":"3.310.0","@aws-sdk/middleware-content-length":"3.310.0","@aws-sdk/middleware-endpoint":"3.310.0","@aws-sdk/middleware-host-header":"3.310.0","@aws-sdk/middleware-logger":"3.310.0","@aws-sdk/middleware-recursion-detection":"3.310.0","@aws-sdk/middleware-retry":"3.310.0","@aws-sdk/middleware-serde":"3.310.0","@aws-sdk/middleware-stack":"3.310.0","@aws-sdk/middleware-user-agent":"3.319.0","@aws-sdk/node-config-provider":"3.310.0","@aws-sdk/node-http-handler":"3.321.1","@aws-sdk/protocol-http":"3.310.0","@aws-sdk/smithy-client":"3.316.0","@aws-sdk/types":"3.310.0","@aws-sdk/url-parser":"3.310.0","@aws-sdk/util-base64":"3.310.0","@aws-sdk/util-body-length-browser":"3.310.0","@aws-sdk/util-body-length-node":"3.310.0","@aws-sdk/util-defaults-mode-browser":"3.316.0","@aws-sdk/util-defaults-mode-node":"3.316.0","@aws-sdk/util-endpoints":"3.319.0","@aws-sdk/util-retry":"3.310.0","@aws-sdk/util-user-agent-browser":"3.310.0","@aws-sdk/util-user-agent-node":"3.310.0","@aws-sdk/util-utf8":"3.310.0",tslib:"^2.5.0"},devDependencies:{"@aws-sdk/service-client-documentation-generator":"3.310.0","@tsconfig/node14":"1.0.3","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typedoc:"0.23.23",typescript:"~4.9.5"},engines:{node:">=14.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sso",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sso"}};import{Buffer as xg}from"buffer";import{createHash as Sg,createHmac as _g}from"crypto";var ve=class{constructor(t,r){this.algorithmIdentifier=t,this.secret=r,this.reset()}update(t,r){this.hash.update(Pe(Ll(t,r)))}digest(){return Promise.resolve(this.hash.digest())}reset(){this.hash=this.secret?_g(this.algorithmIdentifier,Ll(this.secret)):Sg(this.algorithmIdentifier)}};function Ll(e,t){return xg.isBuffer(e)?e:typeof e=="string"?Er(e,t):ArrayBuffer.isView(e)?Lt(e.buffer,e.byteOffset,e.byteLength):Lt(e)}function li(e){let t=[];for(let r of Object.keys(e).sort()){let o=e[r];if(r=Ae(r),Array.isArray(o))for(let s=0,n=o.length;s<n;s++)t.push(`${r}=${Ae(o[s])}`);else{let s=r;(o||typeof o=="string")&&(s+=`=${Ae(o)}`),t.push(s)}}return t.join("&")}import{Agent as Rg,request as Tg}from"http";import{Agent as Ig,request as Cg}from"https";var Ml=["ECONNRESET","EPIPE","ETIMEDOUT"];var pi=e=>{let t={};for(let r of Object.keys(e)){let o=e[r];t[r]=Array.isArray(o)?o.join(","):o}return t};var Ul=(e,t,r=0)=>{r&&e.on("socket",o=>{if(o.connecting){let s=setTimeout(()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))},r);o.on("connect",()=>{clearTimeout(s)})}})};var zl=(e,t,r=0)=>{e.setTimeout(r,()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))})};import{Readable as bg}from"stream";function ui(e,t){(t.headers.Expect||t.headers.expect)==="100-continue"?e.on("continue",()=>{ql(e,t.body)}):ql(e,t.body)}function ql(e,t){t instanceof bg?t.pipe(e):t?e.end(Buffer.from(t)):e.end()}var Ne=class{constructor(t){this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise((r,o)=>{typeof t=="function"?t().then(s=>{r(this.resolveDefaultConfig(s))}).catch(o):r(this.resolveDefaultConfig(t))})}resolveDefaultConfig(t){let{requestTimeout:r,connectionTimeout:o,socketTimeout:s,httpAgent:n,httpsAgent:i}=t||{},a=!0,c=50;return{connectionTimeout:o,requestTimeout:r??s,httpAgent:n||new Rg({keepAlive:a,maxSockets:c}),httpsAgent:i||new Ig({keepAlive:a,maxSockets:c})}}destroy(){var t,r,o,s;(r=(t=this.config)==null?void 0:t.httpAgent)==null||r.destroy(),(s=(o=this.config)==null?void 0:o.httpsAgent)==null||s.destroy()}async handle(t,{abortSignal:r}={}){return this.config||(this.config=await this.configProvider),new Promise((o,s)=>{if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(r!=null&&r.aborted){let l=new Error("Request aborted");l.name="AbortError",s(l);return}let n=t.protocol==="https:",i=li(t.query||{}),a={headers:t.headers,host:t.hostname,method:t.method,path:i?`${t.path}?${i}`:t.path,port:t.port,agent:n?this.config.httpsAgent:this.config.httpAgent},d=(n?Cg:Tg)(a,l=>{let p=new be({statusCode:l.statusCode||-1,headers:pi(l.headers),body:l});o({response:p})});d.on("error",l=>{Ml.includes(l.code)?s(Object.assign(l,{name:"TimeoutError"})):s(l)}),Ul(d,s,this.config.connectionTimeout),zl(d,s,this.config.requestTimeout),r&&(r.onabort=()=>{d.abort();let l=new Error("Request aborted");l.name="AbortError",s(l)}),ui(d,t)})}};var mi=class{constructor(t){this.sessions=[],this.sessions=t??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(t){this.sessions.push(t)}contains(t){return this.sessions.includes(t)}remove(t){this.sessions=this.sessions.filter(r=>r!==t)}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(t){for(let r of this.sessions)r===t&&(r.destroyed||r.destroy())}};import{Writable as Pg}from"stream";var vs=class extends Pg{constructor(){super(...arguments),this.bufferedBytes=[]}_write(t,r,o){this.bufferedBytes.push(t),o()}};var Tt=e=>new Promise((t,r)=>{let o=new vs;e.pipe(o),e.on("error",s=>{o.end(),r(s)}),o.on("error",r),o.on("finish",function(){let s=new Uint8Array(Buffer.concat(this.bufferedBytes));t(s)})});import{fstatSync as Ag,lstatSync as vg}from"fs";var It=e=>{if(!e)return 0;if(typeof e=="string")return Buffer.from(e).length;if(typeof e.byteLength=="number")return e.byteLength;if(typeof e.size=="number")return e.size;if(typeof e.path=="string"||Buffer.isBuffer(e.path))return vg(e.path).size;if(typeof e.fd=="number")return Ag(e.fd).size;throw new Error(`Body Length computation failed for ${e}`)};import{platform as Ng,release as Og}from"os";import{env as jl,versions as kg}from"process";var Bl=()=>{try{return typeof F=="function"&&typeof module<"u"&&F("aws-crt")?["md/crt-avail"]:null}catch{return null}};var Dg="AWS_SDK_UA_APP_ID",Fg="sdk-ua-app-id",Ct=({serviceId:e,clientVersion:t})=>{let r=[["aws-sdk-js",t],[`os/${Ng()}`,Og()],["lang/js"],["md/nodejs",`${kg.node}`]],o=Bl();o&&r.push(o),e&&r.push([`api/${e}`,t]),jl.AWS_EXECUTION_ENV&&r.push([`exec-env/${jl.AWS_EXECUTION_ENV}`]);let s=_({environmentVariableSelector:i=>i[Dg],configFileSelector:i=>i[Fg],default:void 0})(),n;return async()=>{if(!n){let i=await s;n=i?[...r,[`app/${i}`]]:[...r]}return n}};var $g=/^[A-Za-z0-9+/]*={0,2}$/,Pt=e=>{if(e.length*3%4!==0)throw new TypeError("Incorrect padding on base64 string.");if(!$g.exec(e))throw new TypeError("Invalid base64 string.");let t=Er(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)};var At=e=>Lt(e.buffer,e.byteOffset,e.byteLength).toString("base64");var Xl="required",je="fn",Ge="argv",Fr="ref",fi="PartitionResult",Oe="tree",xo="error",So="endpoint",Gl={[Xl]:!1,type:"String"},Vl={[Xl]:!0,default:!1,type:"Boolean"},Ql={[Fr]:"Endpoint"},Zl={[je]:"booleanEquals",[Ge]:[{[Fr]:"UseFIPS"},!0]},ep={[je]:"booleanEquals",[Ge]:[{[Fr]:"UseDualStack"},!0]},ke={},Hl={[je]:"booleanEquals",[Ge]:[!0,{[je]:"getAttr",[Ge]:[{[Fr]:fi},"supportsFIPS"]}]},Wl={[je]:"booleanEquals",[Ge]:[!0,{[je]:"getAttr",[Ge]:[{[Fr]:fi},"supportsDualStack"]}]},Kl=[Ql],Yl=[Zl],Jl=[ep],Lg={version:"1.0",parameters:{Region:Gl,UseDualStack:Vl,UseFIPS:Vl,Endpoint:Gl},rules:[{conditions:[{[je]:"aws.partition",[Ge]:[{[Fr]:"Region"}],assign:fi}],type:Oe,rules:[{conditions:[{[je]:"isSet",[Ge]:Kl},{[je]:"parseURL",[Ge]:Kl,assign:"url"}],type:Oe,rules:[{conditions:Yl,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:xo},{type:Oe,rules:[{conditions:Jl,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:xo},{endpoint:{url:Ql,properties:ke,headers:ke},type:So}]}]},{conditions:[Zl,ep],type:Oe,rules:[{conditions:[Hl,Wl],type:Oe,rules:[{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ke,headers:ke},type:So}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:xo}]},{conditions:Yl,type:Oe,rules:[{conditions:[Hl],type:Oe,rules:[{type:Oe,rules:[{endpoint:{url:"https://portal.sso-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ke,headers:ke},type:So}]}]},{error:"FIPS is enabled but this partition does not support FIPS",type:xo}]},{conditions:Jl,type:Oe,rules:[{conditions:[Wl],type:Oe,rules:[{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ke,headers:ke},type:So}]},{error:"DualStack is enabled but this partition does not support DualStack",type:xo}]},{endpoint:{url:"https://portal.sso.{Region}.{PartitionResult#dnsSuffix}",properties:ke,headers:ke},type:So}]}]},tp=Lg;var rp=(e,t={})=>xt(tp,{endpointParams:e,logger:t.logger});var op=e=>({apiVersion:"2019-06-10",base64Decoder:(e==null?void 0:e.base64Decoder)??Pt,base64Encoder:(e==null?void 0:e.base64Encoder)??At,disableHostPrefix:(e==null?void 0:e.disableHostPrefix)??!1,endpointProvider:(e==null?void 0:e.endpointProvider)??rp,logger:(e==null?void 0:e.logger)??new xe,serviceId:(e==null?void 0:e.serviceId)??"SSO",urlParser:(e==null?void 0:e.urlParser)??Z,utf8Decoder:(e==null?void 0:e.utf8Decoder)??Ce,utf8Encoder:(e==null?void 0:e.utf8Encoder)??Et});var sp="AWS_EXECUTION_ENV",hi="AWS_REGION",yi="AWS_DEFAULT_REGION",np="AWS_EC2_METADATA_DISABLED",ip=["in-region","cross-region","mobile","standard","legacy"],ap="/latest/meta-data/placement/region";var Mg="AWS_DEFAULTS_MODE",Ug="defaults_mode",cp={environmentVariableSelector:e=>e[Mg],configFileSelector:e=>e[Ug],default:"legacy"};var vt=({region:e=_(Re),defaultsMode:t=_(cp)}={})=>yt(async()=>{let r=typeof t=="function"?await t():t;switch(r==null?void 0:r.toLowerCase()){case"auto":return zg(e);case"in-region":case"cross-region":case"mobile":case"standard":case"legacy":return Promise.resolve(r==null?void 0:r.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${ip.join(", ")}, got ${r}`)}}),zg=async e=>{if(e){let t=typeof e=="function"?await e():e,r=await qg();return r?t===r?"in-region":"cross-region":"standard"}return"standard"},qg=async()=>{if(process.env[sp]&&(process.env[hi]||process.env[yi]))return process.env[hi]??process.env[yi];if(!process.env[np])try{let e=await Eo();return(await Be({...e,path:ap})).toString()}catch{}};var dp=e=>{tt(process.version);let t=vt(e),r=()=>t().then(et),o=op(e);return{...o,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:(e==null?void 0:e.bodyLengthChecker)??It,defaultUserAgentProvider:(e==null?void 0:e.defaultUserAgentProvider)??Ct({serviceId:o.serviceId,clientVersion:$l.version}),maxAttempts:(e==null?void 0:e.maxAttempts)??_(ut),region:(e==null?void 0:e.region)??_(Re,it),requestHandler:(e==null?void 0:e.requestHandler)??new Ne(r),retryMode:(e==null?void 0:e.retryMode)??_({...ft,default:async()=>(await r()).retryMode||Ie}),sha256:(e==null?void 0:e.sha256)??ve.bind(null,"sha256"),streamCollector:(e==null?void 0:e.streamCollector)??Tt,useDualstackEndpoint:(e==null?void 0:e.useDualstackEndpoint)??_(st),useFipsEndpoint:(e==null?void 0:e.useFipsEndpoint)??_(nt)}};var Ns=class extends Se{constructor(t){let r=dp(t),o=Fl(r),s=at(o),n=rt(s),i=mt(n),a=i,c=gt(a);super(c),this.config=c,this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(ct(this.config)),this.middlewareStack.use(dt(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(pt(this.config)),this.middlewareStack.use(St(this.config))}destroy(){super.destroy()}};var $r="To refresh this SSO session run 'aws sso login' with the corresponding profile.";var M=class extends ue{constructor(t){super(t),Object.setPrototypeOf(this,M.prototype)}};var Lr=class extends M{constructor(t){super({name:"AccessDeniedException",$fault:"client",...t}),this.name="AccessDeniedException",this.$fault="client",Object.setPrototypeOf(this,Lr.prototype),this.error=t.error,this.error_description=t.error_description}},Mr=class extends M{constructor(t){super({name:"AuthorizationPendingException",$fault:"client",...t}),this.name="AuthorizationPendingException",this.$fault="client",Object.setPrototypeOf(this,Mr.prototype),this.error=t.error,this.error_description=t.error_description}},Ur=class extends M{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),this.name="ExpiredTokenException",this.$fault="client",Object.setPrototypeOf(this,Ur.prototype),this.error=t.error,this.error_description=t.error_description}},zr=class extends M{constructor(t){super({name:"InternalServerException",$fault:"server",...t}),this.name="InternalServerException",this.$fault="server",Object.setPrototypeOf(this,zr.prototype),this.error=t.error,this.error_description=t.error_description}},qr=class extends M{constructor(t){super({name:"InvalidClientException",$fault:"client",...t}),this.name="InvalidClientException",this.$fault="client",Object.setPrototypeOf(this,qr.prototype),this.error=t.error,this.error_description=t.error_description}},Br=class extends M{constructor(t){super({name:"InvalidGrantException",$fault:"client",...t}),this.name="InvalidGrantException",this.$fault="client",Object.setPrototypeOf(this,Br.prototype),this.error=t.error,this.error_description=t.error_description}},jr=class extends M{constructor(t){super({name:"InvalidRequestException",$fault:"client",...t}),this.name="InvalidRequestException",this.$fault="client",Object.setPrototypeOf(this,jr.prototype),this.error=t.error,this.error_description=t.error_description}},Gr=class extends M{constructor(t){super({name:"InvalidScopeException",$fault:"client",...t}),this.name="InvalidScopeException",this.$fault="client",Object.setPrototypeOf(this,Gr.prototype),this.error=t.error,this.error_description=t.error_description}},Vr=class extends M{constructor(t){super({name:"SlowDownException",$fault:"client",...t}),this.name="SlowDownException",this.$fault="client",Object.setPrototypeOf(this,Vr.prototype),this.error=t.error,this.error_description=t.error_description}},Hr=class extends M{constructor(t){super({name:"UnauthorizedClientException",$fault:"client",...t}),this.name="UnauthorizedClientException",this.$fault="client",Object.setPrototypeOf(this,Hr.prototype),this.error=t.error,this.error_description=t.error_description}},Wr=class extends M{constructor(t){super({name:"UnsupportedGrantTypeException",$fault:"client",...t}),this.name="UnsupportedGrantTypeException",this.$fault="client",Object.setPrototypeOf(this,Wr.prototype),this.error=t.error,this.error_description=t.error_description}};var lp=async(e,t)=>{let{hostname:r,protocol:o="https",port:s,path:n}=await t.endpoint(),i={"content-type":"application/json"},a=`${n!=null&&n.endsWith("/")?n.slice(0,-1):n||""}/token`,c;return c=JSON.stringify(v(e,{clientId:[],clientSecret:[],code:[],deviceCode:[],grantType:[],redirectUri:[],refreshToken:[],scope:d=>D(d)})),new I({protocol:o,hostname:r,port:s,method:"POST",headers:i,path:a,body:c})};var pp=async(e,t)=>{if(e.statusCode!==200&&e.statusCode>=300)return Bg(e,t);let r=O({$metadata:he(e)}),o=_e(jo(await up(e.body,t)),"body"),s=v(o,{accessToken:g,expiresIn:to,idToken:g,refreshToken:g,tokenType:g});return Object.assign(r,s),r},Bg=async(e,t)=>{let r={...e,body:await ow(e.body,t)},o=sw(e,r.body);switch(o){case"AccessDeniedException":case"com.amazonaws.ssooidc#AccessDeniedException":throw await Gg(r,t);case"AuthorizationPendingException":case"com.amazonaws.ssooidc#AuthorizationPendingException":throw await Vg(r,t);case"ExpiredTokenException":case"com.amazonaws.ssooidc#ExpiredTokenException":throw await Hg(r,t);case"InternalServerException":case"com.amazonaws.ssooidc#InternalServerException":throw await Wg(r,t);case"InvalidClientException":case"com.amazonaws.ssooidc#InvalidClientException":throw await Kg(r,t);case"InvalidGrantException":case"com.amazonaws.ssooidc#InvalidGrantException":throw await Yg(r,t);case"InvalidRequestException":case"com.amazonaws.ssooidc#InvalidRequestException":throw await Jg(r,t);case"InvalidScopeException":case"com.amazonaws.ssooidc#InvalidScopeException":throw await Xg(r,t);case"SlowDownException":case"com.amazonaws.ssooidc#SlowDownException":throw await Qg(r,t);case"UnauthorizedClientException":case"com.amazonaws.ssooidc#UnauthorizedClientException":throw await Zg(r,t);case"UnsupportedGrantTypeException":case"com.amazonaws.ssooidc#UnsupportedGrantTypeException":throw await ew(r,t);default:let s=r.body;return jg({output:e,parsedBody:s,errorCode:o})}};var jg=Ze(M),Gg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Lr({$metadata:he(e),...r});return S(n,e.body)},Vg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Mr({$metadata:he(e),...r});return S(n,e.body)},Hg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Ur({$metadata:he(e),...r});return S(n,e.body)},Wg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new zr({$metadata:he(e),...r});return S(n,e.body)},Kg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new qr({$metadata:he(e),...r});return S(n,e.body)};var Yg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Br({$metadata:he(e),...r});return S(n,e.body)},Jg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new jr({$metadata:he(e),...r});return S(n,e.body)},Xg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Gr({$metadata:he(e),...r});return S(n,e.body)},Qg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Vr({$metadata:he(e),...r});return S(n,e.body)},Zg=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Hr({$metadata:he(e),...r});return S(n,e.body)},ew=async(e,t)=>{let r=O({}),o=e.body,s=v(o,{error:g,error_description:g});Object.assign(r,s);let n=new Wr({$metadata:he(e),...r});return S(n,e.body)},he=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),tw=(e=new Uint8Array,t)=>e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array),rw=(e,t)=>tw(e,t).then(r=>t.utf8Encoder(r));var up=(e,t)=>rw(e,t).then(r=>r.length?JSON.parse(r):{}),ow=async(e,t)=>{let r=await up(e,t);return r.message=r.message??r.Message,r},sw=(e,t)=>{let r=(n,i)=>Object.keys(n).find(a=>a.toLowerCase()===i.toLowerCase()),o=n=>{let i=n;return typeof i=="number"&&(i=i.toString()),i.indexOf(",")>=0&&(i=i.split(",")[0]),i.indexOf(":")>=0&&(i=i.split(":")[0]),i.indexOf("#")>=0&&(i=i.split("#")[1]),i},s=r(e.headers,"x-amzn-errortype");if(s!==void 0)return o(e.headers[s]);if(t.code!==void 0)return o(t.code);if(t.__type!==void 0)return o(t.__type)};var Kr=class extends H{static getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}constructor(t){super(),this.input=t}resolveMiddleware(t,r,o){this.middlewareStack.use(ee(r,this.serialize,this.deserialize)),this.middlewareStack.use(te(r,Kr.getEndpointParameterInstructions()));let s=t.concat(this.middlewareStack),{logger:n}=r,c={logger:n,clientName:"SSOOIDCClient",commandName:"CreateTokenCommand",inputFilterSensitiveLog:l=>l,outputFilterSensitiveLog:l=>l},{requestHandler:d}=r;return s.resolve(l=>d.handle(l.request,o||{}),c)}serialize(t,r){return lp(t,r)}deserialize(t,r){return pp(t,r)}};var mp=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"awsssooidc"});var fp={name:"@aws-sdk/client-sso-oidc",description:"AWS SDK for JavaScript Sso Oidc Client for Node.js, Browser and React Native",version:"3.321.1",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"tsc -p tsconfig.cjs.json","build:docs":"typedoc","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sso-oidc"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"3.0.0","@aws-crypto/sha256-js":"3.0.0","@aws-sdk/config-resolver":"3.310.0","@aws-sdk/fetch-http-handler":"3.310.0","@aws-sdk/hash-node":"3.310.0","@aws-sdk/invalid-dependency":"3.310.0","@aws-sdk/middleware-content-length":"3.310.0","@aws-sdk/middleware-endpoint":"3.310.0","@aws-sdk/middleware-host-header":"3.310.0","@aws-sdk/middleware-logger":"3.310.0","@aws-sdk/middleware-recursion-detection":"3.310.0","@aws-sdk/middleware-retry":"3.310.0","@aws-sdk/middleware-serde":"3.310.0","@aws-sdk/middleware-stack":"3.310.0","@aws-sdk/middleware-user-agent":"3.319.0","@aws-sdk/node-config-provider":"3.310.0","@aws-sdk/node-http-handler":"3.321.1","@aws-sdk/protocol-http":"3.310.0","@aws-sdk/smithy-client":"3.316.0","@aws-sdk/types":"3.310.0","@aws-sdk/url-parser":"3.310.0","@aws-sdk/util-base64":"3.310.0","@aws-sdk/util-body-length-browser":"3.310.0","@aws-sdk/util-body-length-node":"3.310.0","@aws-sdk/util-defaults-mode-browser":"3.316.0","@aws-sdk/util-defaults-mode-node":"3.316.0","@aws-sdk/util-endpoints":"3.319.0","@aws-sdk/util-retry":"3.310.0","@aws-sdk/util-user-agent-browser":"3.310.0","@aws-sdk/util-user-agent-node":"3.310.0","@aws-sdk/util-utf8":"3.310.0",tslib:"^2.5.0"},devDependencies:{"@aws-sdk/service-client-documentation-generator":"3.310.0","@tsconfig/node14":"1.0.3","@types/node":"^14.14.31",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typedoc:"0.23.23",typescript:"~4.9.5"},engines:{node:">=14.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sso-oidc",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sso-oidc"}};var _p="required",Ve="fn",He="argv",Yr="ref",gi="PartitionResult",De="tree",_o="error",bo="endpoint",hp={[_p]:!1,type:"String"},yp={[_p]:!0,default:!1,type:"Boolean"},bp={[Yr]:"Endpoint"},Rp={[Ve]:"booleanEquals",[He]:[{[Yr]:"UseFIPS"},!0]},Tp={[Ve]:"booleanEquals",[He]:[{[Yr]:"UseDualStack"},!0]},Fe={},Ep={[Ve]:"booleanEquals",[He]:[!0,{[Ve]:"getAttr",[He]:[{[Yr]:gi},"supportsFIPS"]}]},gp={[Ve]:"booleanEquals",[He]:[!0,{[Ve]:"getAttr",[He]:[{[Yr]:gi},"supportsDualStack"]}]},wp=[bp],xp=[Rp],Sp=[Tp],iw={version:"1.0",parameters:{Region:hp,UseDualStack:yp,UseFIPS:yp,Endpoint:hp},rules:[{conditions:[{[Ve]:"aws.partition",[He]:[{[Yr]:"Region"}],assign:gi}],type:De,rules:[{conditions:[{[Ve]:"isSet",[He]:wp},{[Ve]:"parseURL",[He]:wp,assign:"url"}],type:De,rules:[{conditions:xp,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:_o},{type:De,rules:[{conditions:Sp,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:_o},{endpoint:{url:bp,properties:Fe,headers:Fe},type:bo}]}]},{conditions:[Rp,Tp],type:De,rules:[{conditions:[Ep,gp],type:De,rules:[{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fe,headers:Fe},type:bo}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:_o}]},{conditions:xp,type:De,rules:[{conditions:[Ep],type:De,rules:[{type:De,rules:[{endpoint:{url:"https://oidc-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Fe,headers:Fe},type:bo}]}]},{error:"FIPS is enabled but this partition does not support FIPS",type:_o}]},{conditions:Sp,type:De,rules:[{conditions:[gp],type:De,rules:[{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fe,headers:Fe},type:bo}]},{error:"DualStack is enabled but this partition does not support DualStack",type:_o}]},{endpoint:{url:"https://oidc.{Region}.{PartitionResult#dnsSuffix}",properties:Fe,headers:Fe},type:bo}]}]},Ip=iw;var Cp=(e,t={})=>xt(Ip,{endpointParams:e,logger:t.logger});var Pp=e=>({apiVersion:"2019-06-10",base64Decoder:(e==null?void 0:e.base64Decoder)??Pt,base64Encoder:(e==null?void 0:e.base64Encoder)??At,disableHostPrefix:(e==null?void 0:e.disableHostPrefix)??!1,endpointProvider:(e==null?void 0:e.endpointProvider)??Cp,logger:(e==null?void 0:e.logger)??new xe,serviceId:(e==null?void 0:e.serviceId)??"SSO OIDC",urlParser:(e==null?void 0:e.urlParser)??Z,utf8Decoder:(e==null?void 0:e.utf8Decoder)??Ce,utf8Encoder:(e==null?void 0:e.utf8Encoder)??Et});var Ap=e=>{tt(process.version);let t=vt(e),r=()=>t().then(et),o=Pp(e);return{...o,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:(e==null?void 0:e.bodyLengthChecker)??It,defaultUserAgentProvider:(e==null?void 0:e.defaultUserAgentProvider)??Ct({serviceId:o.serviceId,clientVersion:fp.version}),maxAttempts:(e==null?void 0:e.maxAttempts)??_(ut),region:(e==null?void 0:e.region)??_(Re,it),requestHandler:(e==null?void 0:e.requestHandler)??new Ne(r),retryMode:(e==null?void 0:e.retryMode)??_({...ft,default:async()=>(await r()).retryMode||Ie}),sha256:(e==null?void 0:e.sha256)??ve.bind(null,"sha256"),streamCollector:(e==null?void 0:e.streamCollector)??Tt,useDualstackEndpoint:(e==null?void 0:e.useDualstackEndpoint)??_(st),useFipsEndpoint:(e==null?void 0:e.useFipsEndpoint)??_(nt)}};var Os=class extends Se{constructor(t){let r=Ap(t),o=mp(r),s=at(o),n=rt(s),i=mt(n),a=i,c=gt(a);super(c),this.config=c,this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(ct(this.config)),this.middlewareStack.use(dt(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(pt(this.config)),this.middlewareStack.use(St(this.config))}destroy(){super.destroy()}};var wi={},vp=e=>{if(wi[e])return wi[e];let t=new Os({region:e});return wi[e]=t,t};var Np=(e,t)=>vp(t).send(new Kr({clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:e.refreshToken,grantType:"refresh_token"}));var xi=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new oe(`Token is expired. ${$r}`,!1)};var Nt=(e,t,r=!1)=>{if(typeof t>"u")throw new oe(`Value not present for '${e}' in SSO Token${r?". Cannot refresh":""}. ${$r}`,!1)};import{promises as aw}from"fs";var{writeFile:cw}=aw,Op=(e,t)=>{let r=gs(e),o=JSON.stringify(t,null,2);return cw(r,o)};var kp=new Date(0),Dp=(e={})=>async()=>{let t=await bt(e),r=fe(e),o=t[r];if(o){if(!o.sso_session)throw new oe(`Profile '${r}' is missing required property 'sso_session'.`)}else throw new oe(`Profile '${r}' could not be found in shared credentials file.`,!1);let s=o.sso_session,i=(await _s(e))[s];if(!i)throw new oe(`Sso session '${s}' could not be found in shared credentials file.`,!1);for(let m of["sso_start_url","sso_region"])if(!i[m])throw new oe(`Sso session '${s}' is missing required property '${m}'.`,!1);let a=i.sso_start_url,c=i.sso_region,d;try{d=await ws(s)}catch{throw new oe(`The SSO session token associated with profile=${r} was not found or is invalid. ${$r}`,!1)}Nt("accessToken",d.accessToken),Nt("expiresAt",d.expiresAt);let{accessToken:l,expiresAt:p}=d,u={token:l,expiration:new Date(p)};if(u.expiration.getTime()-Date.now()>3e5)return u;if(Date.now()-kp.getTime()<30*1e3)return xi(u),u;Nt("clientId",d.clientId,!0),Nt("clientSecret",d.clientSecret,!0),Nt("refreshToken",d.refreshToken,!0);try{kp.setTime(Date.now());let m=await Np(d,c);Nt("accessToken",m.accessToken),Nt("expiresIn",m.expiresIn);let f=new Date(Date.now()+m.expiresIn*1e3);try{await Op(s,{...d,accessToken:m.accessToken,expiresAt:f.toISOString(),refreshToken:m.refreshToken})}catch{}return{token:m.accessToken,expiration:f}}catch{return xi(u),u}};var lw=15*60*1e3,Ro=!1,Si=async({ssoStartUrl:e,ssoSession:t,ssoAccountId:r,ssoRegion:o,ssoRoleName:s,ssoClient:n,profile:i})=>{let a,c="To refresh this SSO session run aws sso login with the corresponding profile.";if(t)try{let E=await Dp({profile:i})();a={accessToken:E.token,expiresAt:new Date(E.expiration).toISOString()}}catch(E){throw new w(E.message,Ro)}else try{a=await ws(e)}catch{throw new w(`The SSO session associated with this profile is invalid. ${c}`,Ro)}if(new Date(a.expiresAt).getTime()-Date.now()<=lw)throw new w(`The SSO session associated with this profile has expired. ${c}`,Ro);let{accessToken:d}=a,l=n||new Ns({region:o}),p;try{p=await l.send(new Dr({accountId:r,roleName:s,accessToken:d}))}catch(E){throw w.from(E,Ro)}let{roleCredentials:{accessKeyId:u,secretAccessKey:m,sessionToken:f,expiration:h}={}}=p;if(!u||!m||!f||!h)throw new w("SSO returns an invalid temporary credential.",Ro);return{accessKeyId:u,secretAccessKey:m,sessionToken:f,expiration:new Date(h)}};var ks=e=>{let{sso_start_url:t,sso_account_id:r,sso_region:o,sso_role_name:s}=e;if(!t||!r||!o||!s)throw new w(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,!1);return e};var Ds=(e={})=>async()=>{let{ssoStartUrl:t,ssoAccountId:r,ssoRegion:o,ssoRoleName:s,ssoClient:n,ssoSession:i}=e,a=fe(e);if(!t&&!r&&!o&&!s&&!i){let d=(await bt(e))[a];if(!d)throw new w(`Profile ${a} was not found.`);if(!go(d))throw new w(`Profile ${a} is not configured with SSO credentials.`);if(d!=null&&d.sso_session){let E=(await _s(e))[d.sso_session],ie=` configurations in profile ${a} and sso-session ${d.sso_session}`;if(o&&o!==E.sso_region)throw new w("Conflicting SSO region"+ie,!1);if(t&&t!==E.sso_start_url)throw new w("Conflicting SSO start_url"+ie,!1);d.sso_region=E.sso_region,d.sso_start_url=E.sso_start_url}let{sso_start_url:l,sso_account_id:p,sso_region:u,sso_role_name:m,sso_session:f}=ks(d);return Si({ssoStartUrl:l,ssoSession:f,ssoAccountId:p,ssoRegion:u,ssoRoleName:m,ssoClient:n,profile:a})}else{if(!t||!r||!o||!s)throw new w('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"');return Si({ssoStartUrl:t,ssoSession:i,ssoAccountId:r,ssoRegion:o,ssoRoleName:s,ssoClient:n,profile:a})}};var Fp=e=>{let{sso_start_url:t,sso_account_id:r,sso_session:o,sso_region:s,sso_role_name:n}=ks(e);return Ds({ssoStartUrl:t,ssoAccountId:r,ssoSession:o,ssoRegion:s,ssoRoleName:n})()};var _i=e=>!!e&&typeof e=="object"&&typeof e.aws_access_key_id=="string"&&typeof e.aws_secret_access_key=="string"&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1,bi=e=>Promise.resolve({accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token});import{readFileSync as pw}from"fs";var $p=e=>()=>{let{roleArn:t,roleSessionName:r,webIdentityToken:o,providerId:s,policyArns:n,policy:i,durationSeconds:a,roleAssumerWithWebIdentity:c}=e;if(!c)throw new w(`Role Arn '${t}' needs to be assumed with web identity, but no role assumption callback was provided.`,!1);return c({RoleArn:t,RoleSessionName:r??`aws-sdk-js-session-${Date.now()}`,WebIdentityToken:o,ProviderId:s,PolicyArns:n,Policy:i,DurationSeconds:a})};var uw="AWS_WEB_IDENTITY_TOKEN_FILE",mw="AWS_ROLE_ARN",fw="AWS_ROLE_SESSION_NAME",Fs=(e={})=>async()=>hw(e),hw=e=>{let t=(e==null?void 0:e.webIdentityTokenFile)??process.env[uw],r=(e==null?void 0:e.roleArn)??process.env[mw],o=(e==null?void 0:e.roleSessionName)??process.env[fw];if(!t||!r)throw new w("Web identity configuration not specified");return $p({...e,webIdentityToken:pw(t,{encoding:"ascii"}),roleArn:r,roleSessionName:o})()};var Lp=e=>!!e&&typeof e=="object"&&typeof e.web_identity_token_file=="string"&&typeof e.role_arn=="string"&&["undefined","string"].indexOf(typeof e.role_session_name)>-1,Mp=async(e,t)=>Fs({webIdentityTokenFile:e.web_identity_token_file,roleArn:e.role_arn,roleSessionName:e.role_session_name,roleAssumerWithWebIdentity:t.roleAssumerWithWebIdentity})();var Ps=async(e,t,r,o={})=>{let s=t[e];if(Object.keys(o).length>0&&_i(s))return bi(s);if(Rl(s))return Tl(e,t,r,o);if(_i(s))return bi(s);if(Lp(s))return Mp(s,r);if(Pl(s))return Al(r,e);if(go(s))return Fp(s);throw new w(`Profile ${e} could not be found or parsed in shared credentials file.`)};var Up=(e={})=>async()=>{let t=await bt(e);return Ps(fe(e),t,e)};var yw="AWS_EC2_METADATA_DISABLED",zp=e=>process.env[ho]||process.env[fo]?Is(e):process.env[yw]?async()=>{throw new w("EC2 Instance Metadata Service access disabled")}:Cs(e);var $s=(e={})=>yt(Qo(...e.profile||process.env[ai]?[]:[Es()],Ds(e),Up(e),As(e),Fs(e),zp(e),async()=>{throw new w("Could not load credentials from any providers",!1)}),t=>t.expiration!==void 0&&t.expiration.getTime()-Date.now()<3e5,t=>t.expiration!==void 0);var Yp="required",x="type",b="fn",R="argv",Ot="ref",Ut="properties",zt="headers";var Ti="PartitionResult",ye="tree",qt="booleanEquals",G="stringEquals",Jp="sigv4",Xp="us-east-1",Qp="sts",A="endpoint",Zp="https://sts.{Region}.{PartitionResult#dnsSuffix}",To="error",Ii="getAttr",qp={[Yp]:!1,[x]:"String"},Ri={[Yp]:!0,default:!1,[x]:"Boolean"},V={[Ot]:"Region"},eu={[Ot]:"UseFIPS"},tu={[Ot]:"UseDualStack"},Bp={[b]:"isSet",[R]:[{[Ot]:"Endpoint"}]},ru={[Ot]:"Endpoint"},W={url:"https://sts.amazonaws.com",[Ut]:{authSchemes:[{name:Jp,signingRegion:Xp,signingName:Qp}]},[zt]:{}},We={},jp={conditions:[{[b]:G,[R]:[V,"aws-global"]}],[A]:W,[x]:A},ou={[b]:qt,[R]:[eu,!0]},su={[b]:qt,[R]:[tu,!0]},Gp={[b]:qt,[R]:[!0,{[b]:Ii,[R]:[{[Ot]:Ti},"supportsFIPS"]}]},nu={[Ot]:Ti},Vp={[b]:qt,[R]:[!0,{[b]:Ii,[R]:[nu,"supportsDualStack"]}]},Hp={url:Zp,[Ut]:{},[zt]:{}},Ew=[ru],Wp=[ou],Kp=[su],gw={version:"1.0",parameters:{Region:qp,UseDualStack:Ri,UseFIPS:Ri,Endpoint:qp,UseGlobalEndpoint:Ri},rules:[{conditions:[{[b]:"aws.partition",[R]:[V],assign:Ti}],[x]:ye,rules:[{conditions:[{[b]:qt,[R]:[{[Ot]:"UseGlobalEndpoint"},!0]},{[b]:qt,[R]:[eu,!1]},{[b]:qt,[R]:[tu,!1]},{[b]:"not",[R]:[Bp]}],[x]:ye,rules:[{conditions:[{[b]:G,[R]:[V,"ap-northeast-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"ap-south-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"ap-southeast-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"ap-southeast-2"]}],endpoint:W,[x]:A},jp,{conditions:[{[b]:G,[R]:[V,"ca-central-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"eu-central-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"eu-north-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"eu-west-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"eu-west-2"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"eu-west-3"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"sa-east-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,Xp]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"us-east-2"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"us-west-1"]}],endpoint:W,[x]:A},{conditions:[{[b]:G,[R]:[V,"us-west-2"]}],endpoint:W,[x]:A},{endpoint:{url:Zp,[Ut]:{authSchemes:[{name:Jp,signingRegion:"{Region}",signingName:Qp}]},[zt]:We},[x]:A}]},{conditions:[Bp,{[b]:"parseURL",[R]:Ew,assign:"url"}],[x]:ye,rules:[{conditions:Wp,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[x]:To},{[x]:ye,rules:[{conditions:Kp,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[x]:To},{endpoint:{url:ru,[Ut]:We,[zt]:We},[x]:A}]}]},{conditions:[ou,su],[x]:ye,rules:[{conditions:[Gp,Vp],[x]:ye,rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",[Ut]:We,[zt]:We},[x]:A}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[x]:To}]},{conditions:Wp,[x]:ye,rules:[{conditions:[Gp],[x]:ye,rules:[{[x]:ye,rules:[{conditions:[{[b]:G,[R]:["aws-us-gov",{[b]:Ii,[R]:[nu,"name"]}]}],endpoint:Hp,[x]:A},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",[Ut]:We,[zt]:We},[x]:A}]}]},{error:"FIPS is enabled but this partition does not support FIPS",[x]:To}]},{conditions:Kp,[x]:ye,rules:[{conditions:[Vp],[x]:ye,rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",[Ut]:We,[zt]:We},[x]:A}]},{error:"DualStack is enabled but this partition does not support DualStack",[x]:To}]},{[x]:ye,rules:[jp,{endpoint:Hp,[x]:A}]}]}]},iu=gw;var au=(e,t={})=>xt(iu,{endpointParams:e,logger:t.logger});var cu=e=>({apiVersion:"2011-06-15",base64Decoder:(e==null?void 0:e.base64Decoder)??Pt,base64Encoder:(e==null?void 0:e.base64Encoder)??At,disableHostPrefix:(e==null?void 0:e.disableHostPrefix)??!1,endpointProvider:(e==null?void 0:e.endpointProvider)??au,logger:(e==null?void 0:e.logger)??new xe,serviceId:(e==null?void 0:e.serviceId)??"STS",urlParser:(e==null?void 0:e.urlParser)??Z,utf8Decoder:(e==null?void 0:e.utf8Decoder)??Ce,utf8Encoder:(e==null?void 0:e.utf8Encoder)??Et});var du=e=>{tt(process.version);let t=vt(e),r=()=>t().then(et),o=cu(e);return{...o,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:(e==null?void 0:e.bodyLengthChecker)??It,credentialDefaultProvider:(e==null?void 0:e.credentialDefaultProvider)??al($s),defaultUserAgentProvider:(e==null?void 0:e.defaultUserAgentProvider)??Ct({serviceId:o.serviceId,clientVersion:sl.version}),maxAttempts:(e==null?void 0:e.maxAttempts)??_(ut),region:(e==null?void 0:e.region)??_(Re,it),requestHandler:(e==null?void 0:e.requestHandler)??new Ne(r),retryMode:(e==null?void 0:e.retryMode)??_({...ft,default:async()=>(await r()).retryMode||Ie}),sha256:(e==null?void 0:e.sha256)??ve.bind(null,"sha256"),streamCollector:(e==null?void 0:e.streamCollector)??Tt,useDualstackEndpoint:(e==null?void 0:e.useDualstackEndpoint)??_(st),useFipsEndpoint:(e==null?void 0:e.useFipsEndpoint)??_(nt)}};var Bt=class extends Se{constructor(t){let r=du(t),o=ol(r),s=at(o),n=rt(s),i=mt(n),a=i,c=rl(a,{stsClientCtor:Bt}),d=gt(c);super(d),this.config=d,this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(ct(this.config)),this.middlewareStack.use(dt(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(pt(this.config)),this.middlewareStack.use(St(this.config))}destroy(){super.destroy()}};var lu=(e,t)=>t?class extends e{constructor(o){super(o);for(let s of t)this.middlewareStack.use(s)}}:e,ww=(e={},t)=>ni(e,lu(Bt,t)),xw=(e={},t)=>ii(e,lu(Bt,t)),pu=e=>t=>e({roleAssumer:ww(t),roleAssumerWithWebIdentity:xw(t),...t});var Su="required",U="fn",z="argv",Gt="ref",Ls="PartitionResult",$e="tree",Io="error",ce="endpoint",kt="stringEquals",uu={[Su]:!1,type:"String"},mu={[Su]:!0,default:!1,type:"Boolean"},jt={[Gt]:"Region"},_u={[Gt]:"Endpoint"},bu={[U]:"booleanEquals",[z]:[{[Gt]:"UseFIPS"},!0]},Ru={[U]:"booleanEquals",[z]:[{[Gt]:"UseDualStack"},!0]},k={},fu={[U]:"booleanEquals",[z]:[!0,{[U]:"getAttr",[z]:[{[Gt]:Ls},"supportsFIPS"]}]},hu={[U]:"booleanEquals",[z]:[!0,{[U]:"getAttr",[z]:[{[Gt]:Ls},"supportsDualStack"]}]},yu={[U]:"getAttr",[z]:[{[Gt]:Ls},"name"]},Eu={url:"https://ecr-fips.{Region}.{PartitionResult#dnsSuffix}",properties:{},headers:{}},gu=[_u],wu=[bu],xu=[Ru],Sw={version:"1.0",parameters:{Region:uu,UseDualStack:mu,UseFIPS:mu,Endpoint:uu},rules:[{conditions:[{[U]:"aws.partition",[z]:[jt],assign:Ls}],type:$e,rules:[{conditions:[{[U]:"isSet",[z]:gu},{[U]:"parseURL",[z]:gu,assign:"url"}],type:$e,rules:[{conditions:wu,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Io},{type:$e,rules:[{conditions:xu,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Io},{endpoint:{url:_u,properties:k,headers:k},type:ce}]}]},{conditions:[bu,Ru],type:$e,rules:[{conditions:[fu,hu],type:$e,rules:[{endpoint:{url:"https://api.ecr-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:k,headers:k},type:ce}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Io}]},{conditions:wu,type:$e,rules:[{conditions:[fu],type:$e,rules:[{type:$e,rules:[{conditions:[{[U]:kt,[z]:[jt,"dkr-us-east-2"]}],endpoint:{url:"https://ecr-fips.us-east-2.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:[jt,"dkr-us-east-1"]}],endpoint:{url:"https://ecr-fips.us-east-1.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:[jt,"dkr-us-west-2"]}],endpoint:{url:"https://ecr-fips.us-west-2.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:[jt,"dkr-us-west-1"]}],endpoint:{url:"https://ecr-fips.us-west-1.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:["aws",yu]}],endpoint:Eu,type:ce},{conditions:[{[U]:kt,[z]:[jt,"dkr-us-gov-east-1"]}],endpoint:{url:"https://ecr-fips.us-gov-east-1.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:[jt,"dkr-us-gov-west-1"]}],endpoint:{url:"https://ecr-fips.us-gov-west-1.amazonaws.com",properties:k,headers:k},type:ce},{conditions:[{[U]:kt,[z]:["aws-us-gov",yu]}],endpoint:Eu,type:ce},{endpoint:{url:"https://api.ecr-fips.{Region}.{PartitionResult#dnsSuffix}",properties:k,headers:k},type:ce}]}]},{error:"FIPS is enabled but this partition does not support FIPS",type:Io}]},{conditions:xu,type:$e,rules:[{conditions:[hu],type:$e,rules:[{endpoint:{url:"https://api.ecr.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:k,headers:k},type:ce}]},{error:"DualStack is enabled but this partition does not support DualStack",type:Io}]},{endpoint:{url:"https://api.ecr.{Region}.{PartitionResult#dnsSuffix}",properties:k,headers:k},type:ce}]}]},Tu=Sw;var Iu=(e,t={})=>xt(Tu,{endpointParams:e,logger:t.logger});var Cu=e=>({apiVersion:"2015-09-21",base64Decoder:(e==null?void 0:e.base64Decoder)??Pt,base64Encoder:(e==null?void 0:e.base64Encoder)??At,disableHostPrefix:(e==null?void 0:e.disableHostPrefix)??!1,endpointProvider:(e==null?void 0:e.endpointProvider)??Iu,logger:(e==null?void 0:e.logger)??new xe,serviceId:(e==null?void 0:e.serviceId)??"ECR",urlParser:(e==null?void 0:e.urlParser)??Z,utf8Decoder:(e==null?void 0:e.utf8Decoder)??Ce,utf8Encoder:(e==null?void 0:e.utf8Encoder)??Et});var Pu=e=>{tt(process.version);let t=vt(e),r=()=>t().then(et),o=Cu(e);return{...o,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:(e==null?void 0:e.bodyLengthChecker)??It,credentialDefaultProvider:(e==null?void 0:e.credentialDefaultProvider)??pu($s),defaultUserAgentProvider:(e==null?void 0:e.defaultUserAgentProvider)??Ct({serviceId:o.serviceId,clientVersion:id.version}),maxAttempts:(e==null?void 0:e.maxAttempts)??_(ut),region:(e==null?void 0:e.region)??_(Re,it),requestHandler:(e==null?void 0:e.requestHandler)??new Ne(r),retryMode:(e==null?void 0:e.retryMode)??_({...ft,default:async()=>(await r()).retryMode||Ie}),sha256:(e==null?void 0:e.sha256)??ve.bind(null,"sha256"),streamCollector:(e==null?void 0:e.streamCollector)??Tt,useDualstackEndpoint:(e==null?void 0:e.useDualstackEndpoint)??_(st),useFipsEndpoint:(e==null?void 0:e.useFipsEndpoint)??_(nt)}};var Ms=class extends Se{constructor(t){let r=Pu(t),o=nd(r),s=at(o),n=rt(s),i=mt(n),a=i,c=as(a),d=gt(c);super(d),this.config=d,this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(ct(this.config)),this.middlewareStack.use(dt(this.config)),this.middlewareStack.use(lt(this.config)),this.middlewareStack.use(pt(this.config)),this.middlewareStack.use(ds(this.config)),this.middlewareStack.use(St(this.config))}destroy(){super.destroy()}};var Pi=new Ms({});try{let e=(0,N.getInput)("repository-url",{required:!0}),t=(0,N.getInput)("image",{required:!0}),r=(0,N.getMultilineInput)("tags"),o=(0,N.getInput)("build-path")||void 0,s=e.slice(e.lastIndexOf("/")+1),{user:n,password:i}=await Rw(),a=Co("docker",["login","--username",n,"--password-stdin",e],{input:i});(0,N.isDebug)()&&(0,N.debug)(a.toString("utf8"));let c=t.split(":")[1]||"latest",d=`${e}:${c}`;if(o!==void 0){let p=_w(bw(),o);Co("docker",["build","-t",d,p].concat((0,N.isDebug)()?["-D"]:[]),{stdio:"inherit"})}else Co("docker",["tag",t,d].concat((0,N.isDebug)()?["-D"]:[]),{stdio:"inherit"});Co("docker",["push",d].concat((0,N.isDebug)()?["-D"]:[]),{stdio:"inherit"}),await Promise.all(r.map(async p=>{var E,ie,Jr,J,Vt,Ht,Po;let[u,m]=await Promise.all([c,p].map(async Dt=>{let Ao=await Pi.send(new lr({repositoryName:s,imageIds:[{imageTag:Dt}]}));return(0,N.isDebug)()&&(0,N.debug)(`batchGetImageResponse: ${Ci(Ao)}`),Ao})),f=(Jr=(ie=(E=u.images)==null?void 0:E[0])==null?void 0:ie.imageId)==null?void 0:Jr.imageDigest,h=(Ht=(Vt=(J=m.images)==null?void 0:J[0])==null?void 0:Vt.imageId)==null?void 0:Ht.imageDigest;if(f&&f!==h){let Dt=await Pi.send(new ur({repositoryName:s,imageTag:p,imageManifest:(Po=u.images)==null?void 0:Po[0].imageManifest}));return(0,N.isDebug)()&&(0,N.debug)(`putImageResponse: ${Ci(Dt)}`),Dt}}));let l=Co("docker",["logout",e]);(0,N.isDebug)()&&(0,N.debug)(l.toString("utf8"))}catch(e){e instanceof Error&&(0,N.setFailed)(e)}async function Rw(){var s;let e=await Pi.send(new pr({}));(0,N.isDebug)()&&(0,N.debug)(`getAuthorizationTokenResponse: ${Ci(e)}`);let t=(s=e.authorizationData)==null?void 0:s[0].authorizationToken;if(t===void 0)throw Error("Failed to retrieve ECR authorization token.");let[r,o]=Buffer.from(t,"base64").toString("utf8").split(":");return{user:r,password:o}}
//# sourceMappingURL=main.mjs.map
